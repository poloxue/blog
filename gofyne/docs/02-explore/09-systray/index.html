<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='添加系统托盘菜单#
自 v2.2.0 版本以来，Fyne 内置了对系统托盘菜单的支持。此功能在 macOS、Windows 和 Linux 计算机上显示一个图标，当点击时，会弹出由应用程序指定的菜单。
由于这是一个特定于桌面的功能，我们首先必须进行运行时检查，以确认应用程序正在桌面模式下运行。为此，我们进行 Go 类型断言以获取对桌面功能的引用：
	if desk, ok := a.(desktop.App); ok {
...
	}如果 ok 变量为真，则我们可以使用标准 Fyne 菜单 API 设置菜单，你可能之前在 Window.SetMainMenu 中使用过这个 API。
		m := fyne.NewMenu("MyApp",
			fyne.NewMenuItem("Show", func() {
				log.Println("点击了显示")
			}))
		desk.SetSystemTrayMenu(m)将此代码添加到应用程序的设置中，运行应用程序，你会看到系统托盘中显示了一个 Fyne 图标。当你点击它时，会出现一个包含“显示”和“退出”的菜单。
默认图标是 Fyne 标志，你可以通过应用元数据更改这个设置，或者通过 App.SetIcon 或直接使用 desk.SetSystemTrayIcon 为系统托盘设置应用图标。
管理窗口生命周期#
默认情况下，当你关闭所有窗口时 Fyne 应用将会退出，这可能不是你希望的系统托盘应用的行为。要覆盖此行为，你可以使用 Window.SetCloseIntercept 功能来覆盖窗口关闭时的操作。在下面的示例中，我们通过调用 Window.Hide() 来隐藏窗口而不是关闭它。在第一次显示窗口之前添加这个。
	w.SetCloseIntercept(func() {
		w.Hide()
	})隐藏窗口的好处是你可以简单地再次使用 Window.Show() 显示它，如果需要第二次使用相同的内容，这比创建一个新窗口更高效。我们更新之前创建的菜单以显示上面隐藏的窗口。
	fyne.NewMenuItem("Show", func() {
		w.Show()
	}))完整的应用程序#
这就是使用 Fyne 设置系统托盘菜单的全部内容！本教程的完整代码如下所示。
package main

import (
	"fyne.io/fyne/v2"
	"fyne.io/fyne/v2/app"
	"fyne.io/fyne/v2/driver/desktop"
	"fyne.io/fyne/v2/widget"
)

func main() {
	a := app.New()
	w := a.NewWindow("SysTray")

	if desk, ok := a.(desktop.App); ok {
		m := fyne.NewMenu("MyApp",
			fyne.NewMenuItem("Show", func() {
				w.Show()
			}))
		desk.SetSystemTrayMenu(m)
	}

	w.SetContent(widget.NewLabel("Fyne 系统托盘"))
	w.SetCloseIntercept(func() {
		w.Hide()
	})
	w.ShowAndRun()
}'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://www.poloxue.com/gofyne/docs/02-explore/09-systray/"><meta property="og:site_name" content="Go Fyne 中文"><meta property="og:title" content="09. 系统托盘菜单"><meta property="og:description" content='添加系统托盘菜单# 自 v2.2.0 版本以来，Fyne 内置了对系统托盘菜单的支持。此功能在 macOS、Windows 和 Linux 计算机上显示一个图标，当点击时，会弹出由应用程序指定的菜单。
由于这是一个特定于桌面的功能，我们首先必须进行运行时检查，以确认应用程序正在桌面模式下运行。为此，我们进行 Go 类型断言以获取对桌面功能的引用：
if desk, ok := a.(desktop.App); ok { ... }如果 ok 变量为真，则我们可以使用标准 Fyne 菜单 API 设置菜单，你可能之前在 Window.SetMainMenu 中使用过这个 API。
m := fyne.NewMenu("MyApp", fyne.NewMenuItem("Show", func() { log.Println("点击了显示") })) desk.SetSystemTrayMenu(m)将此代码添加到应用程序的设置中，运行应用程序，你会看到系统托盘中显示了一个 Fyne 图标。当你点击它时，会出现一个包含“显示”和“退出”的菜单。
默认图标是 Fyne 标志，你可以通过应用元数据更改这个设置，或者通过 App.SetIcon 或直接使用 desk.SetSystemTrayIcon 为系统托盘设置应用图标。
管理窗口生命周期# 默认情况下，当你关闭所有窗口时 Fyne 应用将会退出，这可能不是你希望的系统托盘应用的行为。要覆盖此行为，你可以使用 Window.SetCloseIntercept 功能来覆盖窗口关闭时的操作。在下面的示例中，我们通过调用 Window.Hide() 来隐藏窗口而不是关闭它。在第一次显示窗口之前添加这个。
w.SetCloseIntercept(func() { w.Hide() })隐藏窗口的好处是你可以简单地再次使用 Window.Show() 显示它，如果需要第二次使用相同的内容，这比创建一个新窗口更高效。我们更新之前创建的菜单以显示上面隐藏的窗口。
fyne.NewMenuItem("Show", func() { w.Show() }))完整的应用程序# 这就是使用 Fyne 设置系统托盘菜单的全部内容！本教程的完整代码如下所示。
package main import ( "fyne.io/fyne/v2" "fyne.io/fyne/v2/app" "fyne.io/fyne/v2/driver/desktop" "fyne.io/fyne/v2/widget" ) func main() { a := app.New() w := a.NewWindow("SysTray") if desk, ok := a.(desktop.App); ok { m := fyne.NewMenu("MyApp", fyne.NewMenuItem("Show", func() { w.Show() })) desk.SetSystemTrayMenu(m) } w.SetContent(widget.NewLabel("Fyne 系统托盘")) w.SetCloseIntercept(func() { w.Hide() }) w.ShowAndRun() }'><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2024-03-18T17:28:49+08:00"><title>09. 系统托盘菜单 | Go Fyne 中文</title><link rel=icon href=/gofyne/favicon.png><link rel=manifest href=/gofyne/manifest.json><link rel=canonical href=https://www.poloxue.com/gofyne/docs/02-explore/09-systray/><link rel=stylesheet href=/gofyne/book.min.a054973c076acda1858dcacdcd63bfd8a2b033a9cea6de3c916c2c7dbb6d5553.css integrity="sha256-oFSXPAdqzaGFjcrNzWO/2KKwM6nOpt48kWwsfbttVVM=" crossorigin=anonymous><script defer src=/gofyne/fuse.min.js></script><script defer src=/gofyne/en.search.min.0c9dcaf991386fd256c9d5bc472e2ccf326bbec8c7a9a095bf3906b9fb3a43ea.js integrity="sha256-DJ3K+ZE4b9JWydW8Ry4szzJrvsjHqaCVvzkGufs6Q+o=" crossorigin=anonymous></script><script defer src=/gofyne/sw.min.91ed9592384f78600f10e97696537ad683594d0a3d2f4c95f02ff26eee652c5c.js integrity="sha256-ke2VkjhPeGAPEOl2llN61oNZTQo9L0yV8C/ybu5lLFw=" crossorigin=anonymous></script><script data-goatcounter=https://poloxue.goatcounter.com/count async src=//gc.zgo.at/count.js></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7019080091542951" crossorigin=anonymous></script></head><body dir=ltr class="book-kind-page book-type-docs"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/gofyne/><img src=/gofyne/logo.png alt=Logo><span>Go Fyne 中文</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><input type=checkbox id=section-4a08b5dde0246ef7b9c8ac71c4ca2664 class=toggle>
<label for=section-4a08b5dde0246ef7b9c8ac71c4ca2664 class=flex><a role=button>快速开始</a>
<img src=/gofyne/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/gofyne/docs/01-started/01-index/>01. 安装指南</a></li><li><a href=/gofyne/docs/01-started/02-hello/>02. 创建第一个应用</a></li><li><a href=/gofyne/docs/01-started/03-demo/>03. 运行 Fyne Demo</a></li><li><a href=/gofyne/docs/01-started/04-apprun/>04. App 和 RunLoop</a></li><li><a href=/gofyne/docs/01-started/05-updating/>05. 更新 GUI 内容</a></li><li><a href=/gofyne/docs/01-started/06-windows/>06. 窗口 Window 处理</a></li><li><a href=/gofyne/docs/01-started/07-testing/>07. 测试 GUI 应用程序</a></li><li><a href=/gofyne/docs/01-started/08-packaging/>08. 打包桌面应用</a></li><li><a href=/gofyne/docs/01-started/09-mobile/>09. 打包移动应用</a></li><li><a href=/gofyne/docs/01-started/10-webapp/>10. 在浏览器中运行</a></li><li><a href=/gofyne/docs/01-started/11-metadata/>11. 应用元数据 Metadata</a></li><li><a href=/gofyne/docs/01-started/12-distribution/>12. 发布到应用商店</a></li><li><a href=/gofyne/docs/01-started/13-cross-compile/>13. 跨平台编译</a></li></ul></li><li><input type=checkbox id=section-bc10ba2ca54d00a940b5cd323e3782ac class=toggle checked>
<label for=section-bc10ba2ca54d00a940b5cd323e3782ac class=flex><a role=button>探索 Fyne</a>
<img src=/gofyne/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/gofyne/docs/02-explore/01-canvas/>01. Canvas 和 CanvasObject</a></li><li><a href=/gofyne/docs/02-explore/02-container/>02. 容器与布局</a></li><li><a href=/gofyne/docs/02-explore/03-widgets/>03. 内置控件 Widget</a></li><li><a href=/gofyne/docs/02-explore/04-layouts/>04. 布局组件</a></li><li><a href=/gofyne/docs/02-explore/05-dialogs/>05. Dialog 对话框</a></li><li><a href=/gofyne/docs/02-explore/06-icons/>06. 主题 Icon 小图标</a></li><li><a href=/gofyne/docs/02-explore/07-shortcuts/>07. 快捷键</a></li><li><a href=/gofyne/docs/02-explore/08-preferences/>08. 偏好设置</a></li><li><a href=/gofyne/docs/02-explore/09-systray/ class=active>09. 系统托盘菜单</a></li><li><a href=/gofyne/docs/02-explore/10-binding/>10. 数据绑定</a></li><li><a href=/gofyne/docs/02-explore/11-compiling/>11. 编译选项</a></li></ul></li><li><input type=checkbox id=section-31a243f9867535db80e2ed29c7dac2fb class=toggle>
<label for=section-31a243f9867535db80e2ed29c7dac2fb class=flex><a role=button>画图和动画</a>
<img src=/gofyne/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/gofyne/docs/03-canvas/01-rectangle/>01. 矩形 Rectangle</a></li><li><a href=/gofyne/docs/03-canvas/02-text/>02. 文本 Text</a></li><li><a href=/gofyne/docs/03-canvas/03-line/>03. 线条 Line</a></li><li><a href=/gofyne/docs/03-canvas/04-circle/>04. 圆 Circle</a></li><li><a href=/gofyne/docs/03-canvas/05-image/>05. 图片 Image</a></li><li><a href=/gofyne/docs/03-canvas/06-raster/>06. 矢量 Raster</a></li><li><a href=/gofyne/docs/03-canvas/07-gradient/>07. 渐变 Gradient</a></li><li><a href=/gofyne/docs/03-canvas/08-animation/>08. 动画 Animation</a></li></ul></li><li><input type=checkbox id=section-0632fe18c2dd4697c4561d4abb203b9c class=toggle>
<label for=section-0632fe18c2dd4697c4561d4abb203b9c class=flex><a role=button>容器与布局</a>
<img src=/gofyne/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/gofyne/docs/04-container/01-box/>01. 盒子 Box</a></li><li><a href=/gofyne/docs/04-container/02-grid/>02. 网格 Grid</a></li><li><a href=/gofyne/docs/04-container/03-gridwrap/>03. 网格包装 Grid Wrap</a></li><li><a href=/gofyne/docs/04-container/04-border/>04. 边框布局 Border</a></li><li><a href=/gofyne/docs/04-container/05-form/>05. 表单布局 Form</a></li><li><a href=/gofyne/docs/04-container/06-center/>06. 居中布局 Center</a></li><li><a href=/gofyne/docs/04-container/07-max/>07. 最大布局 Max</a></li><li><a href=/gofyne/docs/04-container/08-apptabs/>08. Tab 布局 AppTabs</a></li></ul></li><li><input type=checkbox id=section-2d93450d34b69a64672a43ddc88efa2f class=toggle>
<label for=section-2d93450d34b69a64672a43ddc88efa2f class=flex><a role=button>控件</a>
<img src=/gofyne/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/gofyne/docs/05-widget/01-label/>01. 标签 Label</a></li><li><a href=/gofyne/docs/05-widget/02-button/>02. 按钮 Button</a></li><li><a href=/gofyne/docs/05-widget/03-entry/>03. 输入框 Entry</a></li><li><a href=/gofyne/docs/05-widget/04-choices/>04. 复选框 Choices</a></li><li><a href=/gofyne/docs/05-widget/05-form/>05. 表单 Form</a></li><li><a href=/gofyne/docs/05-widget/06-progressbar/>06. 进度条 ProgressBar</a></li><li><a href=/gofyne/docs/05-widget/07-toolbar/>07. 工具栏 Toolbar</a></li></ul></li><li><input type=checkbox id=section-284930110796598077a0cb93c7e0c707 class=toggle>
<label for=section-284930110796598077a0cb93c7e0c707 class=flex><a role=button>集合</a>
<img src=/gofyne/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/gofyne/docs/06-collection/01-list/>01. 列表 List</a></li><li><a href=/gofyne/docs/06-collection/02-table/>02. 表格 Table</a></li><li><a href=/gofyne/docs/06-collection/03-tree/>03. 树 Tree</a></li></ul></li><li><input type=checkbox id=section-c9b27a709ba971af79b5846aa96e3538 class=toggle>
<label for=section-c9b27a709ba971af79b5846aa96e3538 class=flex><a href=/gofyne/docs/07-binding/>数据绑定</a>
<img src=/gofyne/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/gofyne/docs/07-binding/01-simple/>01. 简单绑定</a></li><li><a href=/gofyne/docs/07-binding/02-twoway/>02. 双向绑定</a></li><li><a href=/gofyne/docs/07-binding/03-conversion/>03. 数据转换</a></li><li><a href=/gofyne/docs/07-binding/04-list/>04. 列表类型</a></li></ul></li><li><input type=checkbox id=section-8cb092208ad60826a380d5cdad208263 class=toggle>
<label for=section-8cb092208ad60826a380d5cdad208263 class=flex><a role=button>扩展新类型</a>
<img src=/gofyne/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/gofyne/docs/08-extend/01-custom-layout/>01. 自定义布局 Layout</a></li><li><a href=/gofyne/docs/08-extend/02-custom-widget/>02. 自定义控件 Widget</a></li><li><a href=/gofyne/docs/08-extend/03-bundle/>03. 资源包 Bundle</a></li><li><a href=/gofyne/docs/08-extend/04-custom-theme/>04. 自定义主题 Theme</a></li><li><a href=/gofyne/docs/08-extend/05-extending-widgets/>05. 扩展控件 Widget</a></li><li><a href=/gofyne/docs/08-extend/06-numerical-entry/>06. 数字输入框 Entry</a></li></ul></li><li><input type=checkbox id=section-952a2a13183729a4eba2863907c9a5c1 class=toggle>
<label for=section-952a2a13183729a4eba2863907c9a5c1 class=flex><a role=button>架构</a>
<img src=/gofyne/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/gofyne/docs/09-architecture/01-geometry/>01. 几何 Geometry</a></li><li><a href=/gofyne/docs/09-architecture/02-scaling/>02. 缩放 Scaling</a></li><li><a href=/gofyne/docs/09-architecture/03-widgets/>03. 控件 Widget</a></li><li><a href=/gofyne/docs/09-architecture/04-organisation/>04. 包组织 Package</a></li></ul></li><li><input type=checkbox id=section-8bdd7fbf7e5d15ee42522213810b13e2 class=toggle>
<label for=section-8bdd7fbf7e5d15ee42522213810b13e2 class=flex><a href=/gofyne/docs/10-faq/>常见问题</a>
<img src=/gofyne/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/gofyne/docs/10-faq/01-layout/>01. 布局与控件大小</a></li><li><a href=/gofyne/docs/10-faq/02-theme/>02. 主题与自定义</a></li><li><a href=/gofyne/docs/10-faq/03-troubleshoot/>03. 故障排查</a></li></ul></li><li><a href=/gofyne/docs/11-api/>接口 API 定义</a><ul></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/gofyne/icons/menu.svg class=book-icon alt=Menu></label><h3>09. 系统托盘菜单</h3><label for=toc-control><img src=/gofyne/icons/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#管理窗口生命周期>管理窗口生命周期</a></li><li><a href=#完整的应用程序>完整的应用程序</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=添加系统托盘菜单>添加系统托盘菜单<a class=anchor href=#%e6%b7%bb%e5%8a%a0%e7%b3%bb%e7%bb%9f%e6%89%98%e7%9b%98%e8%8f%9c%e5%8d%95>#</a></h1><p>自 v2.2.0 版本以来，Fyne 内置了对系统托盘菜单的支持。此功能在 macOS、Windows 和 Linux 计算机上显示一个图标，当点击时，会弹出由应用程序指定的菜单。</p><p>由于这是一个特定于桌面的功能，我们首先必须进行运行时检查，以确认应用程序正在桌面模式下运行。为此，我们进行 Go 类型断言以获取对桌面功能的引用：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>desk</span>, <span style=color:#a6e22e>ok</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>a</span>.(<span style=color:#a6e22e>desktop</span>.<span style=color:#a6e22e>App</span>); <span style=color:#a6e22e>ok</span> {
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>	}</span></span></code></pre></div><p>如果 <code>ok</code> 变量为真，则我们可以使用标准 Fyne 菜单 API 设置菜单，你可能之前在 <code>Window.SetMainMenu</code> 中使用过这个 API。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span>		<span style=color:#a6e22e>m</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>fyne</span>.<span style=color:#a6e22e>NewMenu</span>(<span style=color:#e6db74>&#34;MyApp&#34;</span>,
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fyne</span>.<span style=color:#a6e22e>NewMenuItem</span>(<span style=color:#e6db74>&#34;Show&#34;</span>, <span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;点击了显示&#34;</span>)
</span></span><span style=display:flex><span>			}))
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>desk</span>.<span style=color:#a6e22e>SetSystemTrayMenu</span>(<span style=color:#a6e22e>m</span>)</span></span></code></pre></div><p>将此代码添加到应用程序的设置中，运行应用程序，你会看到系统托盘中显示了一个 Fyne 图标。当你点击它时，会出现一个包含“显示”和“退出”的菜单。</p><p>默认图标是 Fyne 标志，你可以通过<a href=/gofyne/docs/01-started/11-metadata/>应用元数据</a>更改这个设置，或者通过 <code>App.SetIcon</code> 或直接使用 <code>desk.SetSystemTrayIcon</code> 为系统托盘设置应用图标。</p><h2 id=管理窗口生命周期>管理窗口生命周期<a class=anchor href=#%e7%ae%a1%e7%90%86%e7%aa%97%e5%8f%a3%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f>#</a></h2><p>默认情况下，当你关闭所有窗口时 Fyne 应用将会退出，这可能不是你希望的系统托盘应用的行为。要覆盖此行为，你可以使用 <code>Window.SetCloseIntercept</code> 功能来覆盖窗口关闭时的操作。在下面的示例中，我们通过调用 <code>Window.Hide()</code> 来隐藏窗口而不是关闭它。在第一次显示窗口之前添加这个。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span>	<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>SetCloseIntercept</span>(<span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Hide</span>()
</span></span><span style=display:flex><span>	})</span></span></code></pre></div><p>隐藏窗口的好处是你可以简单地再次使用 <code>Window.Show()</code> 显示它，如果需要第二次使用相同的内容，这比创建一个新窗口更高效。我们更新之前创建的菜单以显示上面隐藏的窗口。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span>	<span style=color:#a6e22e>fyne</span>.<span style=color:#a6e22e>NewMenuItem</span>(<span style=color:#e6db74>&#34;Show&#34;</span>, <span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Show</span>()
</span></span><span style=display:flex><span>	}))</span></span></code></pre></div><h2 id=完整的应用程序>完整的应用程序<a class=anchor href=#%e5%ae%8c%e6%95%b4%e7%9a%84%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f>#</a></h2><p>这就是使用 Fyne 设置系统托盘菜单的全部内容！本教程的完整代码如下所示。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fyne.io/fyne/v2&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fyne.io/fyne/v2/app&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fyne.io/fyne/v2/driver/desktop&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fyne.io/fyne/v2/widget&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>a</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>New</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>w</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>NewWindow</span>(<span style=color:#e6db74>&#34;SysTray&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>desk</span>, <span style=color:#a6e22e>ok</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>a</span>.(<span style=color:#a6e22e>desktop</span>.<span style=color:#a6e22e>App</span>); <span style=color:#a6e22e>ok</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>m</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>fyne</span>.<span style=color:#a6e22e>NewMenu</span>(<span style=color:#e6db74>&#34;MyApp&#34;</span>,
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fyne</span>.<span style=color:#a6e22e>NewMenuItem</span>(<span style=color:#e6db74>&#34;Show&#34;</span>, <span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Show</span>()
</span></span><span style=display:flex><span>			}))
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>desk</span>.<span style=color:#a6e22e>SetSystemTrayMenu</span>(<span style=color:#a6e22e>m</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>SetContent</span>(<span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewLabel</span>(<span style=color:#e6db74>&#34;Fyne 系统托盘&#34;</span>))
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>SetCloseIntercept</span>(<span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Hide</span>()
</span></span><span style=display:flex><span>	})
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>ShowAndRun</span>()
</span></span><span style=display:flex><span>}</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div></div><div></div></div><div class="flex flex-wrap justify-between"><span><a href=/gofyne/docs/02-explore/08-preferences/ class="flex align-center"><img src=/gofyne/icons/backward.svg class=book-icon alt=Previous title="08. 偏好设置">
<span>08. 偏好设置</span>
</a></span><span><a href=/gofyne/docs/02-explore/10-binding/ class="flex align-center"><span>10. 数据绑定</span>
<img src=/gofyne/icons/forward.svg class=book-icon alt=Next title="10. 数据绑定"></a></span></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script><div class=book-comments><script src=https://utteranc.es/client.js repo=poloxue/blog issue-term=pathname theme=github-dark crossorigin=anonymous async></script></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#管理窗口生命周期>管理窗口生命周期</a></li><li><a href=#完整的应用程序>完整的应用程序</a></li></ul></nav></div></aside></main></body></html>