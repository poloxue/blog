---
title: "期权备兑策略介绍与通过 Python 绘制收益图"
date: 2024-09-08T11:30:27+08:00
draft: false
comment: true
description: "本文介绍备兑期权（covered calls）策略，一个交易者员常用的策略。期权交易看起来复杂，常常使新手却步。然而，一旦正确掌握了，就会变得简单易懂。"
---

- [译文原文 - Covered Call Strategy in Python](https://blog.quantinsti.com/write-covered-call-strategy-in-python/)

本文介绍备兑期权（covered calls）策略，一个交易者员常用的策略。期权交易看起来复杂，常常使新手却步。然而，一旦正确掌握了，就会变得简单易懂。

本博客中，我们将学习备兑期权策略的基础知识，并获取实用且易于理解的见解。我们还将讨论在 Python 中如何实现备兑期权策略，实现通过 Python 实现策略的可视化。这个过程中，我们将强调实践，同时确保深度，让每个部分能被理解。无论是希望拓展交易知识的新手，还是想要优化策略的老手，希望这篇博客都能对你有所帮助。

## 期权交易概述

期权交易涉及到期权合约，这些合约赋予持有人在某个时间内以设定价格买入或卖出某项资产的权利，但不具备买卖的义务。期权有两种类型，即看涨期权和看跌期权。

- **看涨期权**：持有该期权的人有权（但无义务）在到期时以预定价格购买某项标的资产或股票。
- **看跌期权**：持有该期权的人有权（但无义务）在到期时以预定价格卖出某项标的资产或股票。

期权交易的其他关键要素包括“多头”和“空头”，这两者指的是交易者在期权市场中的头寸。

**多头期权**

当交易者持有期权的“多头”头寸时，这意味着他们以某个特定的期权费买入期权合约（买入看涨期权或看跌期权）。这意味着交易者可以进行以下操作：

- **买入看涨期权**：买入标的资产的权利
- **买入看跌期权**：卖出标的资产的权利

**空头期权**

相反，当交易者持有期权的“空头”头寸时，意味着他们通过卖出期权合约赚取一定的期权费。这意味着交易者可以进行以下操作：

- **卖出看涨期权**：卖出标的资产的义务
- **卖出看跌期权**：买入标的资产的义务

要进行期权交易，交易者通常根据市场展望选择策略，分析市场趋势，选择合适的行权价和到期日期，并通过券商平台进行交易，同时了解市场动态和风险管理。

期权交易策略丰富，如常见的额买卖期权、跨式套利、宽跨式套利等。

## 案例

假设你认为目前以每股 50 元交易的 XYZ 公司股票在下个月会涨价。你决定不直接买入股票，而是购买一份 XYZ 公司的看涨期权合约，行权价格为 55 元，合约到期日为一个月后。

下面是此示例的策略分解：

- **操作**：你购买一份 XYZ 公司的看涨期权合约。
- **原因**：你预期 XYZ 公司股票价格将会上涨。

购买看涨期权，你要支付了一定的期权费（如每股 2 元，一份合约计 200 元，合约规模 100 股）。这赋予你在到期日前以每股 55 元购买 100 股 XYZ 公司股票的权利，但非义务。

如果 XYZ 公司的股价在下个月上涨至 55 元以上，你的看涨期权将最大化收益。例如，如果股价上涨至 60 元，你可以行使期权，以 55 元的价格购买股票，然后以市场价 60 元卖出股票，获得每股 5 元的利润（扣除购买期权时支付的期权费）。如果到期时股价未能突破 55 元，你可以让期权失效，只损失所支付的期权费。

## 备兑期权策略

什么是备兑期权策略呢？备兑期权策略涉及拥有标的资产（如股票），并对这些资产卖出看涨期权。其操作方式如下：

**持有标的资产**：首先，投资者持有特定股票。每份期权合约通常覆盖 100 股标的资产。

**卖出看涨期权**：投资者随后卖出看涨期权，以此获得期权买方支付的期权费。

**有卖出的义务**：当卖出看涨期权时，投资者同意在期权买方在到期日之前或到期时行权时，以指定的行权价出售所持股票。

**有限利润潜力**：备兑期权策略的利润潜力限于卖出看涨期权时获得的期权费。如果股票价格低于期权的行权价，该期权通常会失效，投资者则保留期权费作为利润。

**提供下行保护**：卖出看涨期权所获得的期权费为投资者提供了一些下行保护。它降低了标的资产的有效购买价格，提供了一定的缓冲，以应对股票价格下跌的潜在风险。

**机会成本风险**：如果股票价格上涨超过看涨期权的行权价，投资者可能被迫以行权价出售所持股票，从而错过股价继续大幅上涨的潜在收益。

备兑期权策略在对股票的短期前景持中性或略微看涨的情况下时受欢迎，通过该策略从股票持有中产生额外收入，同时可能降低股票的有效购买价格。

## 案例学习

假设 XYZ 股票在 2023 年 4 月 29 日的交易价格为 189 元。现在，按照备兑期权策略，你将采取以下两种头寸：

- **第一步**：以 189 元的价格买入 100 股该股票。
- **第二步**：卖出行权价为 195 的看涨期权，期权到期日为 2023 年 5 月 26 日。看涨期权的期权费为 6.30 元，合约规模为 100 股。

这两笔头寸的总支付金额等于股票价格减去卖出看涨期权获得的期权费，即 18,900 元（买入股票） – 630 元（期权费） = 18,270 元。

如果股票价格上涨超过 195 的行权价，期权将被行权，股票将被卖出，而我们收到的期权费就是最大收益。

而反之，如果到期时股票价格为 180 元，将可能导致损失，具体要计算下股票的波动损失是否大于获得的期权费。

损失 = 获得的期权费 + ((股票到期价格 - 股票购买价格) x 股票数量)

损失 = 630 元 + ((180 - 189) x 100) = -270 元

![](https://d1rwhvwstyk9gu.cloudfront.net/2024/03/Covered-Call.png)

如上图所示是备兑期权的收益图，即多头股票和卖出看涨期权的组合收益图。

## 不同情况示例

具体分解下不同的情况下的收益或亏损，如持有 1 股价值 20 元的 ABC 股票，以 2 元的价格卖出行权价为 23 元的看涨期权。

- **情况 1**：如果股价涨至 20 <= P < 23 元，看涨期权失效，交易者赚取 2 元加上股票价格上涨的收益，总收益为 2 + (P - 20)。利润在 2 元到 5 元之间。
- **情况 2**：如果股价涨至 P >= 23 元，看涨期权的买方将行使期权，以 23 元的价格从交易者处购买股票，因此交易者的净利润为 23 元 - 20 元 + 2 元 = 5 元。利润封顶为 5 元。
- **情况 3**：如果股价跌至 P < 20 元，则看涨期权失效，交易者获得 2 元，而股票头寸的亏损为 2 元 + (P - 20 元)。利润/亏损区间从亏损 18 元到获得 2 元。

通过每月卖出看涨期权，投资者可以每月通过期权费获得收入。

备兑期权的风险回报配置如下：

- **最大风险**：股票购买价格 - 期权费
- **最大收益**：看涨期权行权价 - 股票购买价格 + 期权费
- **盈亏平衡**：股票购买价格 - 期权费

现在已经了解了备兑期权策略的基础，我们将讨论何时使用该策略。

## 何时使用

备兑期权策略在各种情景中被采用，主要是为了从股票持有中产生额外收入。

通过对股票卖出看涨期权，投资者获得期权费，特别是在低波动性市场或股票预计保持稳定时，这种策略能够提升整体收益。当投资者对股票持中性或略微看涨的观点时，他们可以从期权费中获利，同时参与潜在的股价上涨。

此外，投资者可以通过卖出行权价较高的看涨期权来从股票中获利。这在横盘市场中特别有效，期权费可能占到潜在回报的很大一部分，使其对收入产生非常有吸引力。

然而，在实施备兑期权策略之前，必须仔细考虑市场条件、资产波动性和个人投资目标。

接下来我们将讨论备兑期权策略的几种常见变化。

## 备兑期权策略的变化

以下是几种最受欢迎的备兑期权策略变化：

**比例看涨期权卖出**

在这种策略中，投资者卖出超过所持股票数量的看涨期权。例如，他们可能为每持有的 100 股股票卖出两份看涨期权。该策略增加了收益潜力，但如果股票价格大幅上涨，投资者将面临更大的下行风险。

**备兑期权滚动**

当标的股票价格接近或超过卖出看涨期权的行权价时，投资者可以回购期权并卖出一份行权价更高且/或到期日更远的期权。

这让他们能够获得额外的期权费收入，同时有可能从进一步的股价上涨中获益。

**对角线看涨期权价差**

投资者同时卖出一份较近到期的看涨期权，并买入一份行权价更高且到期日较远的看涨期权。该策略允许投资者通过期权费和标的股票的进一步上涨获利。

**备兑跨式期权**

与仅卖出看涨期权不同，投资者同时卖出看涨期权和看跌期权，以增加期权费收入。该策略在低波动性市场中效果显著。

**备兑领口期权**

投资者结合备兑期权策略与购买保护性看跌期权。该策略限制了标的股票的潜在损失，同时仍能通过卖出看涨期权获得收入。

这些变化提供了根据市场状况、个人偏好和投资目标调整风险和回报的方法。但它们也伴随了不同程度的复杂性，可能需要进行仔细的监控和管理。

接下来我们将讨论备兑期权策略在投资组合中的重要性。

## 重要性

备兑期权策略在投资组合中的重要性体现在多个方面，如下是将备兑期权策略纳入投资组合的一些理由：

- **收入来源**：通过卖出看涨期权，获得稳定的收入流。这种收入能够提升整体投资组合的回报，特别是在低利率环境下。
- **风险管理**：备兑期权提供了下行保护，通过减少标的股票的有效购买价格，期权费为股票价格下跌提供了缓冲。
- **增强回报**：虽然收益有限，但在横盘或略微上涨的市场中，备兑期权策略的潜在利润仍能超越传统的买入持有策略。
- **灵活性**：投资者可以根据自己的风险承受能力、市场展望和收入需求调整备兑期权策略，修改行权价、到期日和合约数量等变量。
- **投资组合多样化**：通过将备兑期权策略纳入投资组合，投资者可以使投资组合的收入来源多样化，超越传统的股息或利息支付，从而降低整体投资组合的风险。
- **降低波动性**：通过期权费产生的收入，备兑期权可以平滑投资组合的波动性，为投资者提供更稳定的收益曲线，特别是对于那些风险厌恶型的投资者。

总体而言，备兑期权策略提供了一种平衡的方式来产生收入和管理风险，使其成为投资者在寻求提升投资组合表现和有效管理风险时的重要工具。

接下来我们将讨论使用 AAPL 股票进行备兑期权策略的真实案例。

## 使用 AAPL 备兑期权策略的真实案例

让我们来看一下 2023 年初的 AAPL 案例，查看下面的历史数据，我们可以了解如何利用备兑期权策略。

![](https://d1rwhvwstyk9gu.cloudfront.net/2024/03/AAPL-example-.png)

**场景**：在 2023 年 3 月至 6 月期间，一名交易者持有 100 股苹果公司（AAPL）的股票，当时股票价格在 145 美元到 180 美元间波动。

假设他认为未来几个月股票价格可能保持不变或温和上涨。

**潜在的备兑期权策略**：交易者决定对持有的 AAPL 股票卖出行权价为 200 美元、到期日为六个月后的看涨期权。当时该看涨期权的期权费约为每股 5 美元，这意味着她通过卖出备兑期权可获得 500 美元（100 股 * 5 美元期权费）。

**结果**：

回顾历史数据，AAPL 股票价格在接下来的六个月内确实没有突破 200 元，这就是一个备兑期权策略如何为投资者产生收入的实例，同时如果股价没有上涨过多，投资者还可以继续持有股票。

接下来，我们将在 Python 中逐步实现备兑期权策略可视化收益曲线。

## 如何在 Python 中逐步实现备兑期权策略

下面是使用 Python 代码绘制多头股票、卖出看涨期权和备兑策略的收益图表。

首先是收益计算：

```python
# 备兑期权
import numpy as np
import matplotlib.pyplot as plt

s0=189 # 初始股票价格
k=195; c=6.30; # 期权行权价和期权费
shares = 100 # 每张合约的股票数量
sT = np.arange(0, 2*s0, 5) # 到期时的股票价格
# 多头股票的收益/损失
y1= (sT-s0) * shares
# 卖出看涨期权的收益
y2 = np.where(sT > k,((k - sT) + c) * shares, c * shares)
# 备兑期权的收益
y3 = np.where(sT > k,((k - s0) + c) * shares,((sT - s0) + c) * shares )
```

我们使用 `matplotlib` 库来绘制图表，去除上边界和右边界，并将 X 轴移至中心。使用 `plt.plot` 函数绘制多头股票、卖出看涨期权和备兑期权的收益图表。

```python
# 使用 matplotlib 创建图表
fig, ax = plt.subplots()
ax.spines['top'].set_visible(False) # 隐藏顶部边界
ax.spines['right'].set_visible(False) # 隐藏右侧边界
ax.spines['bottom'].set_position('zero') # 设置 X 轴居中
ax.tick_params(top=False, right=False) # 移除右侧的刻度标记
plt.plot(sT,y1,lw=1.5,label='Long Stock')
plt.plot(sT,y2,lw=1.5,label='Short Call')
plt.plot(sT,y3,lw=1.5,label='Covered Call')
```

最后，我们在图表中添加标题、标签和图例。

```python
plt.title('Covered Call')
plt.xlabel('Stock Prices')
plt.ylabel('Profit/loss')
plt.grid(True)
plt.axis('tight')
plt.legend(loc=0)
plt.show()
```

输出：

![](https://d1rwhvwstyk9gu.cloudfront.net/2024/03/covered-call-Output.png)

接下来，我们将简单说下备兑期权策略的风险管理技巧，这些技巧可以助你最大化收益。

## 备兑期权策略的风险管理技巧

风险管理在实施备兑期权策略时至关重要。以下是管理风险的具体技巧：

- **行权价选择**：选择符合你风险承受能力和市场展望的行权价。卖出行权价远高于当前股价的看涨期权可能带来更高的期权费，但也增加了在期权被行权时面临的潜在损失。
- **到期日管理**：选择既能产生收入又具有灵活性的到期日。较长的到期日通常提供更高的期权费，但也可能增加调整策略的难度。
- **多样化**：在不同的股票、行业或 ETF 之间分散备兑期权头寸，以减少集中风险。避免过度暴露于单一股票或行业，这会增加因不利价格变动带来的风险。
- **监控与调整**：定期监控备兑期权头寸的表现，并在必要时进行调整。如果股票价格接近或超过看涨期权的行权价，考虑回购期权并卖出一份行权价更高或到期日更远的期权，以获取更多期权费收入并可能减少损失。
- **降低风险的策略**：考虑使用保护性看跌期权或领口策略来对冲潜在的下行风险。保护性看跌期权为股票价格下跌提供了保险，而领口策略则通过同时买入看跌期权和卖出备兑看涨期权来限制潜在的损失和收益。
- **仓位管理**：根据你的整体投资组合规模和风险承受能力管理备兑期权头寸的规模。避免在波动性市场中过度投入备兑期权策略，以保持流动性和灵活性。
- **市场分析**：在进入备兑期权头寸之前，进行深入的市场趋势、波动性水平和个股基本面分析。关注经济指标、公司财报公告和可能影响股票价格和期权费的其他因素。

通过采用这些风险管理技巧，投资者可以有效降低与备兑期权策略相关的风险，并优化收入增长和资本保值的潜力。

## 结论

掌握在 Python 中的备兑期权策略为探索期权交易复杂性提供了强大的工具。我们讨论了交易者如何利用这些知识和技能来有效地实施备兑期权策略，从理解基础知识到使用 Python 代码的实际应用。

最终，掌握在 Python 中的备兑期权策略可以为交易者打开机会之门，提升投资组合表现、产生收入并实现财务目标。拥有正确的知识和工具，你可以自信且精准地在动态的期权交易世界中游刃有余。

