---
title: "配对交易基础教程"
date: 2025-04-04T15:24:11+08:00
draft: false
comment: true
description: "本文是翻译自 QuantInsti 的配对交易基础教程。"
---

翻译：[Pairs Trading for Beginners: Correlation, Cointegration, Examples, and Strategy Steps](https://blog.quantinsti.com/pairs-trading-basics/)

配对交易策略是在两只具有协整关系的股票之间寻找交易机会时最流行的策略之一。

如何形成协整关系？如何利用配对交易策略从它们的协整关系中获利？

本篇博客将全面探讨这些问题，内容涵盖：

## 什么是配对交易？

在配对交易策略中，通常会以市场中性方式交易两只股票，即无论市场处于上涨还是下跌趋势，两只股票的开仓头寸都能相互对冲。

配对交易策略的关键挑战在于：

- 筛选具备长期统计套利潜力的股票组合
- 精准把握入场与出场时机

## 配对交易的历史

配对交易策略最早出现于20世纪80年代中期，由摩根士丹利雇佣的一批技术分析师研究团队首创。该策略通过统计分析与技术分析相结合的方法，寻找潜在的市场中性盈利机会。

## 配对交易的底层逻辑是什么？

配对交易策略的核心在于：

两只股票或金融工具的价格走势应当围绕相似均值波动，并保持相对稳定的价差关系。然而在某些情况下，其中一只标的价格可能出现短期偏离。

当这种价差偏离发生时，交易者可以抓住机会做多被低估的金融工具，同时做空被高估的一方。具体头寸建立需综合考量两只股票的实时市场价格及其历史标准差。

## 配对交易核心术语解析

在配对交易策略中，有一些关键术语需要掌握。

### 相关性

相关性通过相关系数ρ量化表示，其取值范围为-1至+1。该系数反映两个变量之间的关联程度：

### 相关性分析

相关性通过相关系数ρ量化表示，其取值范围为-1至+1。该系数反映两个变量之间的关联程度：

- **完全正相关（+1）**：当一个变量上涨或下跌时，另一个变量同向等幅变动
- **完全负相关（-1）**：当一个变量上涨时，另一个变量等幅反向变动
- **零相关（0）**：两个变量不存在线性关联关系

完全正相关指的是：当一个变量无论上涨或下跌时，另一个变量始终保持完全同向且等幅度的变动。

而完全负相关则表现为：当一个变量上涨时，另一个变量呈现完全反向但幅度相等的下跌走势（反之亦然）。

两个变量的相关系数计算公式如下：

$$相关系数(X,Y) = ρ = COV(X,Y) / [SD(X) \cdot SD(Y)]$$

其中：

- COV(X, Y) = X与Y的协方差
- SD(X) 和 SD(Y) = 各自变量的标准差

当相关系数较高时（例如达到0.8），交易者可能会选择该股票对进行配对交易。这一高数值表明两只股票之间存在强关联性——若股票A上涨，股票B同步上涨的概率也相当高。

基于这一假设，交易者会采取市场中性策略——买入股票A同时卖出股票B，买卖决策依据两只股票各自的走势模式而定。

但仅凭相关性分析可能导致伪相关结论。例如，若配对交易策略基于两只股票的价格差（价差=log(a) - nlog(b)，其中a、b分别代表股票A、B的价格），可能出现两只股票价格持续同向增长而永不均值回归的情况。

价差 = log(a) - nlog(b)

当a、b价格同步上涨，但价差持续收窄时（即股票A涨幅小于股票B），由于做空了涨幅更大的股票B，最终将导致投资亏损。

因此，在执行配对交易策略时，仅依靠相关性指标筛选股票对存在风险，需谨慎对待。

### 协整性

配对交易最常用的检验方法是协整检验。协整是指两个或多个时间序列变量之间存在这样的统计特性：它们的线性组合能够形成平稳序列。

具体来说，这里的两个时间序列变量分别是股票A和股票B的价格对数。这两个变量的线性组合可以构成定义价差的线性方程：

价差 = log(a) – nlog(b)

其中 a 代表股票A的市场价格，b 代表股票B的市场价格。操作上，每买入1单位股票A，需卖出n单位股票B

若股票A和B存在协整关系，则上述方程具有平稳性。平稳过程所具有的宝贵特性，正是构建配对交易策略所需的关键条件。

例如在本例中，若该方程平稳，则意味着方程的均值保持长期稳定，方差不会随时间发生显著变化。

假设初始设定对冲比率n使价差=0，根据平稳性特征，价差的期望值将持续保持为0，任何偏离该期望值的情况都构成统计异常，这种异常正是实施配对交易的绝佳时机！

### Z分数（标准分数）

当原始数据服从正态分布时，通过Z分数转换可将其转化为标准正态分布（均值为0，标准差为1）。在配对交易策略中的应用时，这种标准化处理对于设定交易阈值至关重要。

例如，在配对交易中，有股票A和B价格之间价差的分布。我们可以将这些原始价差分数转换为Z分数。

这个新分布将具有均值为0和标准差为1的特性。很容易为此分布创建阈值水平，如1.5sigma、2sigma、2.5sigma 等。

Z分数的计算公式如下：

$$ z = (x – 均值) / 标准差 $$

其中,

x = 原始数据点
z = Z分数

均值和标准差可以是基于 't' 天、分钟或时间间隔内的滚动统计数据。

### ADF 检验

ADF 检验是标准 DF 检验的扩展，用于检验时间序列的平稳性和非平稳性。

与 DF 检验的主要区别在于，ADF 检验可应用于大规模时间序列模型。由于大规模时间序列模型可能更为复杂，因此将 DF 检验改进为 ADF 检验。此外，ADF检验能够处理含有缺失值的数据。

## 配对交易步骤

### 配对交易选股标准

在实施配对交易策略时，所选股票组合必须满足时间序列平稳性要求。平稳的时间序列能确保预测结果准确可靠。

此外，时间序列平稳性表明股票对具有协整关系，可通过交易信号进行配对交易。因此，选股是开展配对交易的关键环节。

理解平稳时间序列是正确选择配对交易股票的核心。当时间序列呈现平稳性时，不仅能保证预测准确性，还能确认股票间的协整关系，从而生成可靠的交易信号。深入掌握这一概念将显著提升您的配对交易策略成效。

对于任意两只股票，价差定义如下：

价差 = log(a) - nlog(b)

其中：
a = 股票A的价格
b = 股票B的价格

假设：对冲比率n为常数

通过回归分析计算n值，使价差尽可能接近0。因此，我们通过对股票价格进行回归来计算对冲比率。

理论依据：在回归分析中，我们会得到一个称为"残差"的项，它表示观测值与拟合曲线或估计值之间的距离。这些残差告诉我们，对于计算得出的n值，实际"价差"与0的偏离程度。

我们通过研究这些残差来判断它们是否呈现趋势性。如果残差没有形成趋势，则意味着价差随机围绕0波动，呈现平稳特性。

对价差序列（代入计算得到的n值）进行 ADF 检验。

ADF 检验是一种假设检验，其检验结果以 p 值呈现。若p值小于0.05或0.01，我们就能以95%或99%的置信度判定该价差序列具有平稳性，从而选择该股票配对。

至此，我们已经探讨了统计套利在选股过程中面临的挑战及相关的统计方法。通过协整检验，我们可以在特定置信区间内确认两只股票的价差序列具有平稳性——即该信号存在均值回归特性。价差计算公式为：

价差 = log(a) - nlog(b)

其中a、b分别代表股票A和B的价格，每买入1单位股票A需卖出n单位股票B，n值通过两只股票的价格回归分析得出。

在确认该价差序列具有均值回归特性后，我们需要确定其波动的极端点位或阈值水平。当价差突破这些阈值时，将触发配对交易指令。

为有效识别这些阈值水平，配对交易中广泛采用名为"Z分数"的统计构建方法。

### 入场点位设定

首先定义价差为's'：
价差 = s = log(a) - nlog(b)

基于't'时间周期的滚动均值和标准差，计算's'的z分数，记为'z'。

将阈值设定在1.5σ至2σ之间（该参数需通过回测优化确定，避免过拟合风险）。

当z分数突破上阈值时，执行做空操作：

- 卖出股票A
- 买入股票B

当z分数突破下阈值时，执行做多操作：

- 买入股票A
- 卖出股票B

需严格保持对冲比例计算交易数量

至此我们已阐明配对交易的入场机制，接下来将探讨交易的另一关键环节——出场点位判定。

### 出场点位设定

**止损**

止损旨在应对预期走势未出现的情况。

例如，当我们选择 2σ 作为入场信号时，预期价差将从该阈值回归均值。但价差可能持续扩大，假设达到2.5σ时已产生亏损。

为控制风险，可将止损位设在3σ水平。

除设置固定止损阈值（如 3σ 或偏离均值的极端值）外，还需持续监测协整关系。若持仓期间协整关系被破坏，则应立即平仓，因该交易的基本假设已不成立。

**止盈**

止盈用于在价格反向波动前锁定利润。例如，当您做多价差时（即根据本文定义买入股票A并卖出股票B），预期价差将回归均值或零值。在盈利情况下，当均值从阈值回归后首次穿过零线时，即可触发止盈。

止盈策略可有多重设定方式，具体取决于你的风险偏好和历史回测结果。

实际交易中，一些因素至关重要，如你的交易经验、综合技能体系、全面分析能力。正如前面强调的，风险承受能力与回测结果将共同决定最优止盈策略。自动化执行与实战应用是本策略的关键。

回顾下，配对交易是通过建立统计关联资产的多空对冲组合来实现的交易策略。该策略本质上是均值回归策略，其核心逻辑是押注价格将回归历史趋势。

## Pairs trading strategy

构建配对交易策略的首要步骤是确保股票对具有协整关系。只有当股票对通过协整检验后，才能被纳入配对交易策略。为验证协整关系，我们采用 ADF 检验。

开展配对交易必须制定完整的交易策略。在实盘交易前，必须全面评估策略的各项参数，包括：

- 最大回撤；
- 平均盈利交易；
- 平均亏损交易；
- 总体盈亏交易；

等等。


## 配对交易的优势

配对交易具有以下优势：

### 降低潜在亏损和风险

当配对交易策略按预期运作时，能有效控制潜在亏损。该策略通过同时操作两只证券来分散风险，若其中一只表现不佳，另一只可抵消部分损失。

### 稳定收益

配对交易策略能使交易者在任何市场条件下获得稳定收益。交易者通过捕捉股票价格偏离均值的机会来实现盈利。

### 对冲保护

配对交易最大的优势在于完全对冲。通过做空高估证券和做多低估证券，天然形成对冲机制，从而限制亏损风险。

## 配对交易的劣势

配对交易存在以下缺点：

### 高度依赖统计相关性

配对交易要求证券间具备高度统计相关性。多数交易者要求至少0.80的相关系数，这在实际操作中较难实现。

### 高昂佣金成本

由于佣金费用较高，部分交易者不建议采用配对交易。有时单次配对交易产生的佣金近乎标准交易的两倍。

### 价格执行风险

配对交易的盈利依赖微薄价差，通常需要大额交易量。这导致在开仓时难以按预期价格成交的风险升高。由于交易量庞大，证券买卖价格的微小差异都可能对最终收益产生重大影响。

## 总结

配对交易是一种基于高度相关性证券在出现偏离后将回归中性位置的假设的交易策略。该策略可应用于各类市场和交易品种，如股票、外汇等。必须谨慎评估证券相关性，因为任何错误的假设或预测都可能导致配对交易策略失败。

如果您是初学者并希望深入了解配对交易策略，我们建议您从这套专门适合配对交易初学者的均值回归策略学习课程开始。该课程包含多个教学模块，能帮助您系统掌握配对交易技能。

