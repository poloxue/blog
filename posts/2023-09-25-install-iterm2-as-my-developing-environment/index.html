<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>终端环境：iTerm2 - POLOXUE's BLOG</title><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="终端环境：iTerm2"><meta itemprop=description content="本系列的目标是介绍如何基于 iTerm2、zsh、Tmux 和 Neovim 搭建我的日常开发环境"><meta itemprop=datePublished content="2023-09-28T19:23:22+08:00"><meta itemprop=dateModified content="2023-09-28T19:23:22+08:00"><meta itemprop=wordCount content="715"><meta itemprop=keywords content="zsh,iterm2,"><meta property="og:title" content="终端环境：iTerm2"><meta property="og:description" content="本系列的目标是介绍如何基于 iTerm2、zsh、Tmux 和 Neovim 搭建我的日常开发环境"><meta property="og:type" content="article"><meta property="og:url" content="https://www.poloxue.com/posts/2023-09-25-install-iterm2-as-my-developing-environment/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-28T19:23:22+08:00"><meta property="article:modified_time" content="2023-09-28T19:23:22+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="终端环境：iTerm2"><meta name=twitter:description content="本系列的目标是介绍如何基于 iTerm2、zsh、Tmux 和 Neovim 搭建我的日常开发环境"><script data-goatcounter=https://poloxue.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/main.css><link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/extra.css><link id=dark-scheme rel=stylesheet type=text/css href=https://www.poloxue.com/css/dark.css><script src=https://www.poloxue.com/js/feather.min.js></script>
<script src=https://www.poloxue.com/js/main.js></script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7019080091542951" crossorigin=anonymous></script></head><body><div class="container-wide wrapper"><div class=header><div class=avatar><a href=https://www.poloxue.com/><img src=/avatar.png alt="POLOXUE's BLOG"></a></div><h1 class=site-title><a href=https://www.poloxue.com/>POLOXUE's BLOG</a></h1><div class=site-description><nav class="nav social"><ul class=flat><li><a href=https://github.com/poloxue/ title=Github><i data-feather=github></i></a></li><li><a href=/posts/index.xml title=RSS><i data-feather=rss></i></a></li><li><a href=/ title=Wechat><i data-feather=message-circle></i></a></li><span class=scheme-toggle><a href=# id=scheme-toggle></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>首页</a></li><li><a href=/posts>文章列表</a></li><li><a href=/tags>分类标签</a></li><li><a href=/about/>关于我</a></li></ul></nav></div><div class=article-nav id=article-nav-id><div class=post><div class=post-header><div class=meta><div class=date><span class=day>28</span>
<span class=rest>Sep 2023</span></div></div><div class=matter><h1 class=title>终端环境：iTerm2</h1></div></div><aside class="show-on-mobile toc" id=static-toc><header><h3>Contents</h3></header><nav id=TableOfContents><ol><li><a href=#前言介绍>前言介绍</a></li><li><a href=#iterm2-vs-默认-terminal>iTerm2 vs 默认 Terminal</a></li><li><a href=#下载安装>下载安装</a></li><li><a href=#颜色面板主题>颜色面板主题</a></li><li><a href=#如何使用>如何使用</a><ol><li><a href=#分屏功能>分屏功能</a></li><li><a href=#分屏最大化>分屏最大化</a></li><li><a href=#支持搜索>支持搜索</a></li><li><a href=#其他>其他</a></li></ol></li><li><a href=#高级能力-python-api>高级能力 Python API</a><ol><li><a href=#自动更换背景图>自动更换背景图</a></li><li><a href=#布局自动化>布局自动化</a></li></ol></li><li><a href=#最后>最后</a></li></ol></nav></aside><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2023-09/2023-09-25-install-iterm2-as-my-developing-environment-15.png alt></p><p>视频版本，没有文章详细：</p><div id=video-619786097vNX_sReGZ5E style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden></div><script>var r=new XMLHttpRequest;r.addEventListener("load",function(){container=document.getElementById("video-619786097vNX_sReGZ5E"),data=JSON.parse(this.responseText),bb_id="619786097",yt_id="vNX_sReGZ5E",data.country_code=="CN"||yt_id==0&&bb_id!=0?container.innerHTML='<iframe src="https://player.bilibili.com/player.html?aid='+bb_id+'&amp;page=1" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0;" allowfullscreen title="Bilibili Video" ></iframe > ':yt_id!=0&&(container.innerHTML='<iframe src="https://www.youtube.com/embed/'+yt_id+'"style="position:absolute;top:0;left:0;width:100%;height:100%; border:0;" title="YouTube video player" frameborder="0" allow="accelerometer;autoplay;clipboard-write;encrypted-media;gyroscope;picture-in-picture;web-share"allowfullscreen></iframe>')}),r.open("GET","https://ipapi.co/json/"),r.send()</script><p>我想大部分程序员在平时的工作中都是离不开终端，特别是如果你的系统是 MacOS 或 Linux 的话，终端的地位更是遥遥领先。</p><p>本系列的目标是介绍如何基于 iTerm2、zsh、oh-my-zsh（包括高效插件）、高效 shell 命令，甚至将计划基于 Tmux 和 Neovim 搭建我的日常开发环境。</p><p>本文是搭建我的开发环境系列中的第一篇，将介绍第一个必不可可少的工具终端 - iTerm2，Mac 系统上的终端神器。</p><h2 id=前言介绍>前言介绍</h2><p>我将主要介绍如何安装与配置 iTerm2，安装成功后，会带着一起体验的一些能力。</p><p>首先，iTerm2 是一款终端软件，它是 macOS 下默认终端 Terminal 的替代品。每次拿到新电脑，或者因某种原因重装系统，我首先要做的就是下载 iTerm2 来替换默认的终端 terminal。</p><h2 id=iterm2-vs-默认-terminal>iTerm2 vs 默认 Terminal</h2><p>为什么要用 iTerm2 替换默认的系统终端呢？这总要一些原因吧。</p><p>首先，iTerm2 相较于 Terminal 的优势就是，它更加美观，相对于默认终端，iTerm2 支持真彩，而且，你可以在终端显示图片，甚至是 gif 动图。</p><p>其他功能如分屏能力、颜色面板主题配置、搜索等肯定是基本能力，但毫无疑问，比默认终端体验更友好，更优秀。还有，快捷键的定制性更强。展示静态图片和 GIF 也不在话下。另外，iTerm2，支持如 python 编程控制，可实现自动换背景效果。</p><p>还有，与 iTerm2 与 zsh 相结合体验更佳，zsh 部分会在后面慢慢介绍。</p><blockquote><p>系列阅读：</p><ul><li><a href=https://www.poloxue.com/posts/2023-09-25-install-iterm2-as-my-developing-environment/>终端环境：iTerm2</a></li><li><a href=https://poloxue.com/posts/2023-10-16-zsh-themes-and-plugins/>终端环境：zsh 安装与主题，推荐 7 个提升效率的 zsh 插件</a></li><li><a href=https://www.poloxue.com/posts/2023-10-19-zsh-6-powerful-plugins/>终端环境：6 个强大的 zsh 插件</a></li><li><a href=https://www.poloxue.com/posts/2023-10-20-zsh-theme-powerlevel10k/>终端环境：与众不同的 zsh 主题 - powerlevel10k</a></li><li><a href=https://www.poloxue.com/posts/2023-10-28-high-productivity-shell-commands-part1/>终端环境：高效 shell 命令（一）之目录文件命令 - exa、zoxide 与 bat</a></li><li><a href=https://www.poloxue.com/posts/2023-10-30-high-productivity-shell-commands-part2/>终端环境：高效 shell 命令（二）之高效查找与搜索 - fd ripgrep fzf</a></li><li><a href=https://www.poloxue.com/posts/2023-11-02-high-productivity-shell-commands-part3/>终端环境：高效 shell 命令（三）之提效 web 开发 - entr httpie jq</a></li><li><a href=https://www.poloxue.com/posts/2023-11-07-high-productivity-shell-commands-part4/>终端环境：高效 shell 命令（四）之20+1 个 modern-unix 命令</a></li><li><a href=https://www.poloxue.com/posts/2023-11-15-beautify-your-terminal-welcome-message>终端环境：终端启动消息 - ASCII art</a></li><li><a href=https://www.poloxue.com/posts/2023-11-16-beautify-your-terminal-welcome-using-fetch/>终端环境：终端启动消息 - pfetch/neofetch/fastfetch</a></li></ul><p>更多待续&mldr;</p></blockquote><p>废话不多说，接下来，让我们进入安装使用流程。</p><h2 id=下载安装>下载安装</h2><p>安装可通过 <a href=https://iterm2.com/>iTerm2 官网</a> 下载或者 MacOS 中 <code>brew</code> 安装，我将以 brew 安装为例。</p><p>如果还未安装 brew，安装命令：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/bin/bash -c <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>安装 iterm2，命令如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>brew install --cask iterm2
</span></span></code></pre></td></tr></table></div></div><p>等待执行完成，即安装完毕。</p><h2 id=颜色面板主题>颜色面板主题</h2><p>iTerm2 支持自定义颜色面板 color preset 设置。</p><p>首先，以 material design colors 为例，介绍如何安装设置。</p><p>安装命令，如下所示：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -Ls https://raw.githubusercontent.com/MartinSeeler/iterm2-material-design/master/material-design-colors.itermcolors &gt; /tmp/material-design-colors.itermcolors <span style=color:#f92672>&amp;&amp;</span> open /tmp/material-design-colors.itermcolors
</span></span></code></pre></td></tr></table></div></div><p>如果成功执行，将会在 iTerm2 的 Preferences （使用快捷键 CMD+, 可快捷打开）-> Color 下的 &ldquo;Color Presets&rdquo; 中新增一条颜色面板选项，即 &ldquo;material-design-color&rdquo;。选中确认即可将 iTerm2 默认的颜色面板修改为 &ldquo;material-design-color&rdquo;。</p><p>上面的命令是通过 <code>curl</code> 下载配色文件，通过 <code>open</code> 打开直接安装。其实，稍微麻烦一点做法是，可通过设置面板 import 导入下载的后缀为 itermcolors 的文件。</p><p>如下所示：</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2023-09/2023-09-25-install-iterm2-as-my-developing-environment-07-v1.png alt></p><p>想有更多的选择，再安装两个配色方案：</p><p>安装 Snazzy：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -Ls https://raw.githubusercontent.com/sindresorhus/iterm2-snazzy/main/Snazzy.itermcolors &gt; /tmp/Snazzy.itermcolors <span style=color:#f92672>&amp;&amp;</span> open /tmp/Snazzy.itermcolors
</span></span></code></pre></td></tr></table></div></div><p>安装 Dracula:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -Ls https://raw.githubusercontent.com/dracula/iterm/master/Dracula.itermcolors &gt; /tmp/Dracula.itermcolors <span style=color:#f92672>&amp;&amp;</span> open /tmp/Dracula.itermcolors
</span></span></code></pre></td></tr></table></div></div><p>查看 Color Presets 面板，如下所示：</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2023-09/2023-09-25-install-iterm2-as-my-developing-environment-01.png alt></p><p>选择一款你钟爱的配色，保存。</p><p>如果还没有满意的，可以从 <a href=https://iterm2colorschemes.com/>Iterm2-color-schemes</a> 查找更多配色方案</p><h2 id=如何使用>如何使用</h2><p>打开 &lsquo;iTerm2&rsquo;，快速使用体验一下吧。</p><h3 id=分屏功能>分屏功能</h3><p>如下图所示，&ldquo;CommandL+d&rdquo; 垂直分屏，&ldquo;Command+D&rdquo; 水平分屏。</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2023-09/2023-09-25-install-iterm2-as-my-developing-environment-02.jpeg alt></p><p>当然，这个快捷键是可以配置的，因为这两个快捷键趋势不够便捷。我们打开它的快捷键配置，进入 Preferences -> Keys -> key Binds 即可开始设置快捷键键。</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2023-09/2023-09-25-install-iterm2-as-my-developing-environment-08.png alt></p><p>其中的红色框内容可用于设置如何水平和垂直分割屏幕：</p><ul><li>SHIFT+COMMAND+| -> 水平切片 split horizontally；</li><li>SHIFT+COMMAND+- -> 水平切片 split horizontally；</li></ul><p>其中的蓝色框区域可用于设置 vim 风格的上下左右分屏切换：</p><ul><li>COMMAND+h：向左选中</li><li>COMMAND+j：向下选中</li><li>COMMAND+k：向上选中</li><li>COMMAND+l：向右选中</li></ul><p>对于习惯使用 vim，但不是每个任务都有打开 tmux + vim 组合的时候，这个快捷键的设置就是效率神器啊。</p><h3 id=分屏最大化>分屏最大化</h3><p>如下图所示，&ldquo;Shift+Command+Enter&rdquo; 分屏最大化。</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2023-09/2023-09-25-install-iterm2-as-my-developing-environment-03.jpeg alt></p><p>再次 &ldquo;Shift+Command+Enter&rdquo; 恢复分屏。</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2023-09/2023-09-25-install-iterm2-as-my-developing-environment-04.jpeg alt></p><p>如果你习惯于在终端工作，那么分屏功能肯定是日常使用最多的能力了吧。如上的三分屏幕效果，左边座位代码编辑区域、右上方用于调试或运行代码，下面可用于其他一些测试或者运行命令区域。</p><h3 id=支持搜索>支持搜索</h3><p>相对于 通过 &ldquo;Command+f&rdquo; 开启搜索框：</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2023-09/2023-09-25-install-iterm2-as-my-developing-environment-05.jpeg alt></p><blockquote><p>注：图片取自 <a href="https://techwiser.com/terminal-vs-iterm2-comparison/#:~:text=1.-,Multiple%20Panes,panes%2C%20in%20the%20same%20window">Terminal vs iTerm2: Comparing Two CLI Tools on macOS</a></p></blockquote><p>iTerm2 的搜索能力更强大，可以在搜索框下拉仔细检查下它能力。</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2023-09/2023-09-25-install-iterm2-as-my-developing-environment-10.png alt></p><p>诸如默认的 smartcase 模式、大小写敏感和不敏感模式、正则。可能你觉得这些不是很正常吗？俗话说，没有对比就没有伤害，如果你和系统默认的终端对比下就知道它的优秀之处了。</p><h3 id=其他>其他</h3><p>iTerm2 是真彩 256 colors，这才让我们可以在 iTerm2 将 neovim 打造成媲美 vscode 的 IDE。</p><p>真彩测试，如下所示；</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2023-09/2023-09-25-install-iterm2-as-my-developing-environment-12.png alt></p><p>获取脚本，访问<a href=https://github.com/gnachman/iTerm2/blob/master/tests/24-bit-color.sh>脚本地址</a>。</p><p>IDE 效果：</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2023-09/2023-09-25-install-iterm2-as-my-developing-environment-14.png alt></p><p>还有，我们可以直接在 iTerm2 查看图片，静态图片和 GIF 都是支持的。</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2023-09/2023-09-25-install-iterm2-as-my-developing-environment-11.png alt>
<img src=https://cdn.jsdelivr.net/gh/poloxue/images@2023-09/2023-09-25-install-iterm2-as-my-developing-environment-13.gif alt></p><p>我现在就希望有一天终端支持内置浏览器，实现我 360 度无死角不用离开终端的梦想。我知道有一些文本 browser，如 w3m、lynx、links 等等。还有 browsh 这样的利用 firefox 渲染，终端展示的图形化支持的浏览器。但体验都巨差，无法真正意义上替换浏览器。</p><p>我的梦啊！</p><h2 id=高级能力-python-api>高级能力 Python API</h2><p>这部分主要介绍 iTerm2 提供的 Python API，利用它，带你实现一些不一样的能力。我将演示两个案例，分别是背景图自动更换和分屏创建自动化。</p><h3 id=自动更换背景图>自动更换背景图</h3><p>编程枯燥无味，想通过背景图为枯燥生活提供一些趣味。假设，我们要设计一个脚本，给终端一小时自动更好一个背景图。</p><p>假设我的壁纸图片都在 <code>~/Public/images/beauties</code> 目录下。</p><p>实现下这个代码，如下所示：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> iterm2
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> random
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> asyncio
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 替换背景图片的函数</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>change_background</span>(session, image_path):
</span></span><span style=display:flex><span>    <span style=color:#75715e># 获取当前会话的配置文件</span>
</span></span><span style=display:flex><span>    profile <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> session<span style=color:#f92672>.</span>async_get_profile()
</span></span><span style=display:flex><span>    <span style=color:#75715e># 设置背景图像位置</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> profile<span style=color:#f92672>.</span>async_set_background_image_location(image_path)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>(connection):
</span></span><span style=display:flex><span>    app <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> iterm2<span style=color:#f92672>.</span>async_get_app(connection)
</span></span><span style=display:flex><span>    window <span style=color:#f92672>=</span> app<span style=color:#f92672>.</span>current_terminal_window
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> window <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    session <span style=color:#f92672>=</span> window<span style=color:#f92672>.</span>current_tab<span style=color:#f92672>.</span>current_session
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 获取脚本参数提供的目录</span>
</span></span><span style=display:flex><span>    directory <span style=color:#f92672>=</span> sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>1</span>] <span style=color:#66d9ef>if</span> len(sys<span style=color:#f92672>.</span>argv) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#34;.&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>isdir(directory):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Provided path </span><span style=color:#e6db74>{</span>directory<span style=color:#e6db74>}</span><span style=color:#e6db74> is not a directory&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:  <span style=color:#75715e># 创建无限循环以定期更换背景</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 获取目录中的所有图片文件</span>
</span></span><span style=display:flex><span>        image_files <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>            os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(directory, f)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> f <span style=color:#f92672>in</span> os<span style=color:#f92672>.</span>listdir(directory)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> f<span style=color:#f92672>.</span>lower()<span style=color:#f92672>.</span>endswith((<span style=color:#e6db74>&#34;.png&#34;</span>, <span style=color:#e6db74>&#34;.jpg&#34;</span>, <span style=color:#e6db74>&#34;.jpeg&#34;</span>, <span style=color:#e6db74>&#34;.tiff&#34;</span>, <span style=color:#e6db74>&#34;.bmp&#34;</span>, <span style=color:#e6db74>&#34;.gif&#34;</span>))
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> image_files:
</span></span><span style=display:flex><span>            <span style=color:#75715e># 随机选择一张图片</span>
</span></span><span style=display:flex><span>            chosen_image <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>abspath(random<span style=color:#f92672>.</span>choice(image_files))
</span></span><span style=display:flex><span>            <span style=color:#75715e># 调用函数更改背景</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>await</span> change_background(session, chosen_image)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;No images found in directory </span><span style=color:#e6db74>{</span>directory<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 等待一个小时</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> asyncio<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>3600</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>iterm2<span style=color:#f92672>.</span>run_until_complete(main)
</span></span></code></pre></td></tr></table></div></div><p>代码中提供了注释说明。</p><p>定时能力，我们是通过 <code>sleep(3600)</code> 实现每小时随机更换背景图片。特别说明，不要用 crontab，因为存在环境上下文问题，crontab 无法知道 iTerm2 的存在。</p><p>这个脚本可以放在 sh 的启动脚本中，如 <code>bashrc</code>、<code>zshrc</code> 等，这取决于你用什么 shell。我们只要将其设置为后台常驻的形式运行，</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python random-bg.py your-images-directory &amp;
</span></span></code></pre></td></tr></table></div></div><h3 id=布局自动化>布局自动化</h3><p>如果，你用 tmux 的话，可能知道有布局管理工具是可帮你将布局自动创建的。其实，裸用 iTerm2 的情况下，同样可实现，因为 iTerm2 的 Python API 提供了分屏创建接口。</p><p>示例代码如下所示：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> iterm2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>(connection):
</span></span><span style=display:flex><span>    app <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> iterm2<span style=color:#f92672>.</span>async_get_app(connection)
</span></span><span style=display:flex><span>    window <span style=color:#f92672>=</span> app<span style=color:#f92672>.</span>current_terminal_window
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> window <span style=color:#f92672>is</span> <span style=color:#f92672>not</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        session <span style=color:#f92672>=</span> window<span style=color:#f92672>.</span>current_tab<span style=color:#f92672>.</span>current_session
</span></span><span style=display:flex><span>        <span style=color:#75715e># 垂直分屏</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> session<span style=color:#f92672>.</span>async_split_pane(vertical<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>        <span style=color:#75715e># 如果你想要水平分屏，将vertical参数设置为False</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># await session.async_split_pane(vertical=False)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;No current window&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>iterm2<span style=color:#f92672>.</span>run_until_complete(main)
</span></span></code></pre></td></tr></table></div></div><p>重点就是那句 <code>await session.async_split_pane(vertical=True)</code>，执行这个角度会自动进行左右分屏，即垂直分屏。</p><p>假设，你想自定义一些布局的话，如前面提到这个效果，如下所示：</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2023-09/2023-09-25-install-iterm2-as-my-developing-environment-02.jpeg alt></p><p>我们来实现一个命令自动创建这个效果。</p><p>需求详细描述，iTerm2 自动创建三个 pane 的布局，左边 pane 用于通过 vim 命令打开指定目录（IDE 写代码)，右边上下两个 pane 中，上面的 pane 执行 <code>go run *.go</code> 命令，下面的 pane 创建清空等待输入。</p><p>编写这样一个脚本来实现这个流程，代码如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> iterm2
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>(connection):
</span></span><span style=display:flex><span>    <span style=color:#75715e># 获取要打开的目录作为参数</span>
</span></span><span style=display:flex><span>    directory <span style=color:#f92672>=</span> sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>1</span>] <span style=color:#66d9ef>if</span> len(sys<span style=color:#f92672>.</span>argv) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#34;.&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    app <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> iterm2<span style=color:#f92672>.</span>async_get_app(connection)
</span></span><span style=display:flex><span>    window <span style=color:#f92672>=</span> app<span style=color:#f92672>.</span>current_terminal_window
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> window <span style=color:#f92672>is</span> <span style=color:#f92672>not</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        <span style=color:#75715e># 创建左边的pane</span>
</span></span><span style=display:flex><span>        left_session <span style=color:#f92672>=</span> window<span style=color:#f92672>.</span>current_tab<span style=color:#f92672>.</span>current_session
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> left_session<span style=color:#f92672>.</span>async_send_text(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;cd </span><span style=color:#e6db74>{</span>directory<span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> left_session<span style=color:#f92672>.</span>async_send_text(<span style=color:#e6db74>&#34;vim</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 创建右边的pane</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 右上的pane保持空白</span>
</span></span><span style=display:flex><span>        top_right_session <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> left_session<span style=color:#f92672>.</span>async_split_pane(vertical<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> top_right_session<span style=color:#f92672>.</span>async_send_text(<span style=color:#e6db74>&#34;\clear</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> top_right_session<span style=color:#f92672>.</span>async_send_text(<span style=color:#e6db74>&#34;go run *.go</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 在右下的pane执行go run *.go</span>
</span></span><span style=display:flex><span>        bottom_right_session <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> top_right_session<span style=color:#f92672>.</span>async_split_pane(vertical<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>await</span> bottom_right_session<span style=color:#f92672>.</span>async_send_text(<span style=color:#e6db74>&#34;\clear</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;No current window&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>iterm2<span style=color:#f92672>.</span>run_until_complete(main)
</span></span></code></pre></td></tr></table></div></div><p>就不啰嗦代码逻辑了，非常简单。</p><p>命令效果，如下所示：</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2023-09/2023-09-25-install-iterm2-as-my-developing-environment-09.gif alt></p><p>Python API 的使用就演示这两个案例。想了解它的更多能力，可直接查看它的官方文档，访问 <a href=https://iterm2.com/python-api/>iTemr2 Python API Documentation</a>。</p><h2 id=最后>最后</h2><p>本文重点介绍了 iTerm2 的安装、颜色面板的配置，还有体验其核心的能力，最有趣的部分是通过 iTerm2 的 Python API 能力，实现了一些自动化任务（自动更换背景和布局管理），提高趣味性和效率。</p><p>博文地址：<a href=https://www.poloxue.com/posts/2023-09-25-install-iterm2-as-my-developing-environment/>终端环境：iTerm2 的安装、体验，还有自动换背景、自动管理布局</a></p></div><nav class="hide-on-mobile section-nav"><nav id=TableOfContents><ol><li><a href=#前言介绍>前言介绍</a></li><li><a href=#iterm2-vs-默认-terminal>iTerm2 vs 默认 Terminal</a></li><li><a href=#下载安装>下载安装</a></li><li><a href=#颜色面板主题>颜色面板主题</a></li><li><a href=#如何使用>如何使用</a><ol><li><a href=#分屏功能>分屏功能</a></li><li><a href=#分屏最大化>分屏最大化</a></li><li><a href=#支持搜索>支持搜索</a></li><li><a href=#其他>其他</a></li></ol></li><li><a href=#高级能力-python-api>高级能力 Python API</a><ol><li><a href=#自动更换背景图>自动更换背景图</a></li><li><a href=#布局自动化>布局自动化</a></li></ol></li><li><a href=#最后>最后</a></li></ol></nav></nav></div><div class=post><hr class=footer-separator><div class=tags><ul class=flat><li class=tag-li><a href=/tags/zsh>zsh</a></li><li class=tag-li><a href=/tags/iterm2>iterm2</a></li></ul></div><div class=back><a href=https://www.poloxue.com/><span aria-hidden=true>← Back</span></a></div><div class=back></div></div><div class=post><img style=width:85% src=https://cdn.jsdelivr.net/gh/poloxue/images@main/wechat.png><div class=utterances></div><script src=https://utteranc.es/client.js repo=poloxue/blog issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div><div class="footer wrapper"><nav class=nav><div>2023 Polo Xue All rights reserved</div></nav></div><script>feather.replace()</script><script>var enableTruncate=!0,filterDepth=!1;const MAX_DEPTH=9;window.addEventListener("DOMContentLoaded",()=>{const e=new IntersectionObserver(e=>{e.reverse().forEach(e=>{const n=e.target.getAttribute("id");if(e.intersectionRatio>0){var t=document.querySelectorAll(`nav li a[href="#${n}"]`);t!=null&&t.forEach(e=>{if(e!=null){var t=getDepth(e.parentElement);filterDepth&&t<=MAX_DEPTH&&(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))}else filterDepth||(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))})}})});document.querySelectorAll("h1[id],h2[id],h3[id],h4[id]").forEach(t=>{e.observe(t)})});function isVisible(e){if(!(e instanceof Element))return!1;const n=getComputedStyle(e);if(n.display==="none")return!1;if(n.visibility!=="visible")return!1;if(n.opacity<.1)return!1;if(e.offsetWidth+e.offsetHeight+e.getBoundingClientRect().height+e.getBoundingClientRect().width===0)return!1;const t={x:e.getBoundingClientRect().left+e.offsetWidth/2,y:e.getBoundingClientRect().top+e.offsetHeight/2};if(t.x<0)return!1;if(t.x>(document.documentElement.clientWidth||window.innerWidth))return!1;if(t.y<0)return!1;if(t.y>(document.documentElement.clientHeight||window.innerHeight))return!1;let s=document.elementFromPoint(t.x,t.y);do if(s===e)return!0;while(s=s.parentNode)return!1}function clearActiveStatesInTableOfContents(){document.querySelectorAll("nav li").forEach(e=>{e.classList.remove("active")})}function getDepth(e){for(var t=0;e!==null&&e.tagName.toLowerCase()!=="ul";)t++,e=e.parentElement;return t}function navItems(){var e=document.querySelectorAll("nav nav li a");return Array.from(e).filter(e=>e.href!=null&&e.hash.startsWith("#"))}function lasItemInNavBarVisible(){var e=navItems().slice(-1)[0];return isVisible(e)}document.addEventListener("DOMContentLoaded",function(){if(!enableTruncate)return;var e=navItems();console.log(e),lasItemInNavBarVisible()||(filterDepth=!0,e.forEach(function(e){var t=getDepth(e.parentElement);t>MAX_DEPTH&&e.parentElement.classList.add("depth-nested")}))})</script></body></html>