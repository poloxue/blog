<!doctype html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>从头构建 Go Web 框架（一）：介绍 - 菠萝学量化</title><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="从头构建 Go Web 框架（一）：介绍"><meta itemprop=description content="本系列文章写于 2014 年，相较于 golang 极短的发展历程，这已经是古董级别的一篇文章了，但 web 框架思想概念依然有效。系统通过这个系列文章，能让大家都现有 Go Web 框架有更深的认识。
本文是 “构建属于自己的 Web 框架” 系列文章中的第二篇，将介绍中间件的最佳实践。
第 1 部分：简介，Build Your Own Web Framework In Go 第 2 部分：Go 中间件：最佳实践和示例，Part 2: Middlewares in Go: Best practices and examples 第 3 部分：中间件数据共享，Part 3: Share Values Between Middlewares 第 4 部分：第三方路由，Part 4: Guide to 3rd Party Routers in Golang 第 5 部分：使用 MongoDB 实现 JSON-API，How to implement JSON-API standard in MongoDB and Go 附加福利：上传文件到 s3，Bonus: File Upload REST API with Go and Amazon S3 Martini 发布之后，迅速成为了最受大家欢迎的 Go 语言 Web 框架，且现在依旧是如此。但必须指出的是，它不符合常规习惯，非常慢，概念也有不足。它教了我们一堆错误的做法。但因为它上手容易，许多开发人员仍在使用。"><meta itemprop=datePublished content="2021-10-23T20:33:14+08:00"><meta itemprop=dateModified content="2021-10-23T20:33:14+08:00"><meta itemprop=wordCount content="218"><meta itemprop=keywords content="Golang,Web"><meta property="og:url" content="https://www.poloxue.com/posts/2021-10-23-build-your-own-webframework-in-golang/"><meta property="og:site_name" content="菠萝学量化"><meta property="og:title" content="从头构建 Go Web 框架（一）：介绍"><meta property="og:description" content="本系列文章写于 2014 年，相较于 golang 极短的发展历程，这已经是古董级别的一篇文章了，但 web 框架思想概念依然有效。系统通过这个系列文章，能让大家都现有 Go Web 框架有更深的认识。
本文是 “构建属于自己的 Web 框架” 系列文章中的第二篇，将介绍中间件的最佳实践。
第 1 部分：简介，Build Your Own Web Framework In Go 第 2 部分：Go 中间件：最佳实践和示例，Part 2: Middlewares in Go: Best practices and examples 第 3 部分：中间件数据共享，Part 3: Share Values Between Middlewares 第 4 部分：第三方路由，Part 4: Guide to 3rd Party Routers in Golang 第 5 部分：使用 MongoDB 实现 JSON-API，How to implement JSON-API standard in MongoDB and Go 附加福利：上传文件到 s3，Bonus: File Upload REST API with Go and Amazon S3 Martini 发布之后，迅速成为了最受大家欢迎的 Go 语言 Web 框架，且现在依旧是如此。但必须指出的是，它不符合常规习惯，非常慢，概念也有不足。它教了我们一堆错误的做法。但因为它上手容易，许多开发人员仍在使用。"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-10-23T20:33:14+08:00"><meta property="article:modified_time" content="2021-10-23T20:33:14+08:00"><meta property="article:tag" content="Golang"><meta property="article:tag" content="Web"><meta name=twitter:card content="summary"><meta name=twitter:title content="从头构建 Go Web 框架（一）：介绍"><meta name=twitter:description content="本系列文章写于 2014 年，相较于 golang 极短的发展历程，这已经是古董级别的一篇文章了，但 web 框架思想概念依然有效。系统通过这个系列文章，能让大家都现有 Go Web 框架有更深的认识。
本文是 “构建属于自己的 Web 框架” 系列文章中的第二篇，将介绍中间件的最佳实践。
第 1 部分：简介，Build Your Own Web Framework In Go 第 2 部分：Go 中间件：最佳实践和示例，Part 2: Middlewares in Go: Best practices and examples 第 3 部分：中间件数据共享，Part 3: Share Values Between Middlewares 第 4 部分：第三方路由，Part 4: Guide to 3rd Party Routers in Golang 第 5 部分：使用 MongoDB 实现 JSON-API，How to implement JSON-API standard in MongoDB and Go 附加福利：上传文件到 s3，Bonus: File Upload REST API with Go and Amazon S3 Martini 发布之后，迅速成为了最受大家欢迎的 Go 语言 Web 框架，且现在依旧是如此。但必须指出的是，它不符合常规习惯，非常慢，概念也有不足。它教了我们一堆错误的做法。但因为它上手容易，许多开发人员仍在使用。"><script data-goatcounter=https://poloxue.goatcounter.com/count async src=//gc.zgo.at/count.js></script><link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/main.css><link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/extra.css><link id=dark-scheme rel=stylesheet type=text/css href=https://www.poloxue.com/css/dark.css><script src=https://www.poloxue.com/js/feather.min.js></script><script src=https://www.poloxue.com/js/main.js></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["[","]"],["$$","$$"]],inlineMath:[["(",")"],["$","$"]]}}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7019080091542951" crossorigin=anonymous></script></head><body><div class="container wrapper"><div class=header><div class=avatar><a href=https://www.poloxue.com/><img src=/avatar.png alt=菠萝学量化></a></div><h1 class=site-title><a href=https://www.poloxue.com/>菠萝学量化</a></h1><div class=site-description><nav class="nav social"><ul class=flat><li><a href=https://github.com/poloxue/ title=Github><i data-feather=github></i></a></li><li><a href=/posts/index.xml title=RSS><i data-feather=rss></i></a></li><li><a href=/ title=Wechat><i data-feather=message-circle></i></a></li><span class=scheme-toggle><a href=# id=scheme-toggle></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>文章列表</a></li><li><a href=/tags>分类标签</a></li><li><a href=/about/about>关于我</a></li></ul></nav></div><div class=post><div class=post-header><div class=meta><div class=date><span class=day>23</span>
<span class=rest>Oct 2021</span></div></div><div class=matter><h1 class=title>从头构建 Go Web 框架（一）：介绍</h1></div></div><blockquote><p>本系列文章写于 2014 年，相较于 golang 极短的发展历程，这已经是古董级别的一篇文章了，但 web 框架思想概念依然有效。系统通过这个系列文章，能让大家都现有 Go Web 框架有更深的认识。</p></blockquote><p>本文是 &ldquo;构建属于自己的 Web 框架&rdquo; 系列文章中的第二篇，将介绍中间件的最佳实践。</p><ul><li><a href=https://www.poloxue.com/posts/2021-10-23-build-your-own-webframework-in-golang>第 1 部分：简介</a>，<a href=https://www.nicolasmerouze.com/build-web-framework-golang>Build Your Own Web Framework In Go</a></li><li><a href=https://www.poloxue.com/posts/2021-10-28-build-your-own-webframework-in-golang-part-2>第 2 部分：Go 中间件：最佳实践和示例</a>，<a href=https://nicolasmerouze.notion.site/Part-2-Middlewares-in-Go-Best-practices-and-examples-32f41ae0e21b435c86cf9dd38bf0ff65>Part 2: Middlewares in Go: Best practices and examples</a></li><li><a href>第 3 部分：中间件数据共享</a>，<a href=https://www.nicolasmerouze.com/share-values-between-middlewares-context-golang>Part 3: Share Values Between Middlewares</a></li><li><a href>第 4 部分：第三方路由</a>，<a href=https://nicolasmerouze.notion.site/Part-4-Guide-to-3rd-Party-Routers-in-Go-8ddcca5c360b4539a601ae383c9d7e5d>Part 4: Guide to 3rd Party Routers in Golang</a></li><li><a href>第 5 部分：使用 MongoDB 实现 JSON-API</a>，<a href=https://nicolasmerouze.notion.site/Part-5-How-to-implement-JSON-API-standard-in-MongoDB-and-Go-a3daeead140846e4a6ae1e3c01b47f52>How to implement JSON-API standard in MongoDB and Go</a></li><li><a href>附加福利：上传文件到 s3</a>，<a href=https://nicolasmerouze.notion.site/Bonus-File-Upload-REST-API-with-Go-and-Amazon-S3-1130fbacad7442c5b0a7df9320d792b4>Bonus: File Upload REST API with Go and Amazon S3</a></li></ul><p><a href=https://github.com/go-martin/martini>Martini</a> 发布之后，迅速成为了最受大家欢迎的 Go 语言 Web 框架，且现在依旧是如此。但必须指出的是，它不符合常规习惯，非常慢，概念也有不足。它教了我们一堆错误的做法。但因为它上手容易，许多开发人员仍在使用。</p><p>似乎是存在即合理！</p><p>故而，我决定写一系列文章，基于现有库从头编写组件来构建自己的 Web 框架。在开始前，我搜罗和阅读了市面上绝大部分关于如何编写 Go Web 应用的资料。我希望，通过系列文章能教授 Go Web 开发人员一些最佳实践，同时能提醒老 Go 开发人员什么才是 Web 开发的最佳实践。</p><h1 id=概要>概要</h1><p>本系列不仅能让你了解 Go 中 Web 开发的最佳实践，还会让你了解其他常见问题的解决方案，以及如何正确运用其他框架。</p><h2 id=框架该具备什么能力>框架该具备什么能力</h2><p>市面主要有两种类型的 Web 框架。</p><p>一种是内置所有功能，类似 Rails 的框架，能帮你快速构建与引导项目。Go 中类似框架有：Beego 和 Revel。</p><p>另一种，类似于 Sinatra 的框架，提供路由和一些内置功能，但不会提供 ORM 等功能。 多数 Go 框架都采用了这种风格，如 Martini、Goji、gocraft/web 等。</p><h2 id=框架与库>框架与库</h2><p>最近，发生了一场争论，主题是，究竟是该使用框架还是使用库呢？</p><p>首先，我不反对框架，但 Go 有很棒的小包，能帮助我们非常容易地制作出自己的框架。特别是长期项目，自己动手是更明智的选择。如果你想学习围棋，最好了解一切是如何运作的。</p><p>争论详情查看以下文章：</p><p><a href=https://richardeng.medium.com/the-case-for-go-web-frameworks-a791fcd79d47>The Case for Go Web Frameworks</a>
<a href=https://dave.cheney.net/2014/10/26/go-frameworks-and-ludditry>Go, frameworks, and Ludditry</a>
<a href=https://www.evanjones.ca/frameworks-necessary-for-large-scale-software.html>Frameworks: Necessary for large-scale software</a>
<a href=https://stephensearles.com/framework-vs-library/>Framework vs Library</a></p><h1 id=框架功能>框架功能</h1><p>我们将专注于后一种类型，因为涵盖 Beego 或 Revel 中的每个功能将意味着针对该主题编写一整本书！</p><p>框架主要包含 3 个部分，分别是：</p><ul><li>一是 router，负责接收 request 并路由到指定 handler；</li><li>二是 middleware，handler 前后新增的复用性代码；</li><li>三是 handler 处理程序，负责处理请求并写入响应。</li></ul><p>常见的中间件 Middleware：</p><ul><li>error/panic</li><li>logging</li><li>security</li><li>sessions</li><li>cookies</li><li>body parsing</li></ul><h1 id=go-web-框架现状>Go Web 框架现状</h1><p>现在，许多 Go Web 框架的问题在于，它们的组件仅适用于自身，是不可替换的。</p><p>假设现在有这样一些小包，只有路由器，或只有中间件系统，或者只有中间件，且它们彼此兼容，我们就可以将它们组合使用。 但现实是，这类项目数量极少，除了 Gorilla 之外，基本没什么知名度。当然，即使是 Gorilla，在 Github 上的追随者与其他大多数其他框架，依然少很多。</p><p>Go 的 Middleware 系统并没有统一的约定惯例。与 Ruby (Rack)、Node.js (Connect.js)、Clojure (Ring) 和其他语言不同。 每个框架，如 Negroni、Goji、Gin、gocraft/web 等，都在重新定义自己的中间件工作方式，重用开源中间件变得不可能。</p><p>什么才是开发人员的最佳实践？请阅读下一篇，<a href=https://www.poloxue.com/posts/2021-10-28-build-your-own-webframework-in-golang-part-2>从头构建 Go Web 框架</a>。</p><p>博文地址：<a href=https://www.poloxue.com/posts/2021-10-23-build-your-own-webframework-in-golang/>从头构建 Go Web 框架</a>，译：<a href=https://www.nicolasmerouze.com/build-web-framework-golang>Build Your Own Framework in Golang</a>。</p><div>本文来源于 <a href=https://www.poloxue.com>POLOXUE's BLOG</a>，地址： <a href=https://www.poloxue.com/posts/2021-10-23-build-your-own-webframework-in-golang/>从头构建 Go Web 框架（一）：介绍</a><hr class=footer-separator><div class=tags><ul class=flat><li class=tag-li><a href=/tags/golang>Golang</a></li><li class=tag-li><a href=/tags/web>Web</a></li></ul></div><div class=back><a href=https://www.poloxue.com/><span aria-hidden=true>← Back</span></a></div><div class=back></div></div><div class=post>欢迎关注我的公众号：<img style=width:85% src=https://cdn.jsdelivr.net/gh/poloxue/images@main/wechat.png><div class=utterances></div><script src=https://utteranc.es/client.js repo=poloxue/blog issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div><div class="footer wrapper"><nav class=nav><div>2021 Polo Xue All rights reserved</div></nav></div><script>feather.replace()</script></body></html>