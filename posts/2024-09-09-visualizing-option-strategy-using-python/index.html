<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Python 三方库 Opstrat 绘制收益图加深期权策略理解 - POLOXUE's BLOG</title><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="Python 三方库 Opstrat 绘制收益图加深期权策略理解"><meta itemprop=description content="本文介绍介绍一个 Python 包- opstrat，通过它绘制期权收益图，帮助我们理解期权策略的收益风险比。"><meta itemprop=datePublished content="2024-09-09T11:43:05+08:00"><meta itemprop=dateModified content="2024-09-09T11:43:05+08:00"><meta itemprop=wordCount content="167"><meta itemprop=keywords content><meta property="og:title" content="Python 三方库 Opstrat 绘制收益图加深期权策略理解"><meta property="og:description" content="本文介绍介绍一个 Python 包- opstrat，通过它绘制期权收益图，帮助我们理解期权策略的收益风险比。"><meta property="og:type" content="article"><meta property="og:url" content="https://www.poloxue.com/posts/2024-09-09-visualizing-option-strategy-using-python/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-09T11:43:05+08:00"><meta property="article:modified_time" content="2024-09-09T11:43:05+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Python 三方库 Opstrat 绘制收益图加深期权策略理解"><meta name=twitter:description content="本文介绍介绍一个 Python 包- opstrat，通过它绘制期权收益图，帮助我们理解期权策略的收益风险比。"><script data-goatcounter=https://poloxue.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/main.css><link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/extra.css><link id=dark-scheme rel=stylesheet type=text/css href=https://www.poloxue.com/css/dark.css><script src=https://www.poloxue.com/js/feather.min.js></script>
<script src=https://www.poloxue.com/js/main.js></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script>
<script>MathJax={tex:{displayMath:[["[","]"],["$$","$$"]],inlineMath:[["(",")"],["$","$"]]}}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7019080091542951" crossorigin=anonymous></script></head><body><div class="container wrapper"><div class=header><div class=avatar><a href=https://www.poloxue.com/><img src=/avatar.png alt="POLOXUE's BLOG"></a></div><h1 class=site-title><a href=https://www.poloxue.com/>POLOXUE's BLOG</a></h1><div class=site-description><nav class="nav social"><ul class=flat><li><a href=https://github.com/poloxue/ title=Github><i data-feather=github></i></a></li><li><a href=/posts/index.xml title=RSS><i data-feather=rss></i></a></li><li><a href=/ title=Wechat><i data-feather=message-circle></i></a></li><span class=scheme-toggle><a href=# id=scheme-toggle></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>文章列表</a></li><li><a href=/tags>分类标签</a></li><li><a href=https://crypto.poloxue.com/>每日币圈</a></li><li><a href=/about/about>关于我</a></li></ul></nav></div><div class=post><div class=post-header><div class=meta><div class=date><span class=day>09</span>
<span class=rest>Sep 2024</span></div></div><div class=matter><h1 class=title>Python 三方库 Opstrat 绘制收益图加深期权策略理解</h1></div></div><p>本文介绍介绍一个 Python 包- opstrat，通过它绘制期权收益图，帮助我们理解期权策略的收益风险比。</p><h2 id=什么是期权收益图>什么是期权收益图？</h2><p>期权收益图展示了某个期权或期权组合的盈亏情况，如下图中，展示一张标的现价 100，行权价 102 的看涨期权合约。</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2024-09/2024-09-09-visualizing-option-strategy-02.png alt></p><p>这种图表是理解风险与收益的重要工具，尤其是在期权的交易结构中，通过这些图表可以直观地看到交易的潜在利润与风险区间。</p><h2 id=opstrat>Opstrat</h2><p><a href=https://github.com/hashABCD/opstrat>Opstrat</a> 是一个 Python 工具包，它提供了便捷的方法来可视化期权交易策略，无需复杂的编程知识。通过这个工具，交易者能够快速构建单个期权或者多个期权组合的收益图。</p><h2 id=安装>安装</h2><p>你可以通过以下命令安装 Opstrat：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pip install opstrat
</span></span></code></pre></td></tr></table></div></div><p>该包会自动安装所需的依赖库，包括 <code>pandas</code>、<code>matplotlib</code>、<code>seaborn</code> 和 <code>yfinance</code>，这些都是用来处理数据和绘图的库。</p><h2 id=使用-opstrat-进行期权可视化>使用 Opstrat 进行期权可视化</h2><p>安装完成后，你可以通过如下方式导入该包：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> opstrat <span style=color:#66d9ef>as</span> op
</span></span></code></pre></td></tr></table></div></div><p>接下来，我们将展示如何使用 <code>opstrat</code> 绘制各种期权策略的收益图。</p><h3 id=绘制单个期权的收益图>绘制单个期权的收益图</h3><p>要绘制单个期权的收益图，你可以使用 <code>single_plotter()</code> 函数。</p><p>如绘制一张默认的看涨期权收益图：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>op<span style=color:#f92672>.</span>single_plotter()
</span></span></code></pre></td></tr></table></div></div><p>默认生成一个看涨期权的收益图，现价为 100 元，行权价为 102 元。</p><p>如下图所示：</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2024-09/2024-09-09-visualizing-option-strategy-02.png alt></p><h3 id=自定义单腿期权>自定义单腿期权</h3><p>通过提供参数，你可以自定义这个图表。例如，假设交易者卖出了行权价为 400 元的看跌期权，并收取了 12 元的期权费。以下代码将生成该卖出期权的收益图：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>op<span style=color:#f92672>.</span>single_plotter(spot<span style=color:#f92672>=</span><span style=color:#ae81ff>400</span>, strike<span style=color:#f92672>=</span><span style=color:#ae81ff>400</span>, op_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;p&#39;</span>, tr_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;s&#39;</span>, op_pr<span style=color:#f92672>=</span><span style=color:#ae81ff>12</span>)
</span></span></code></pre></td></tr></table></div></div><p>如下图：</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2024-09/2024-09-09-visualizing-option-strategy-03.png alt></p><p>这个图表显示不同价格水平下的潜在盈利或亏损。<code>tr_type</code> 参数 <code>s</code> 表示 <code>short</code> 空这张 PUT 期权，如果为 <code>b</code> 表示是 <code>buy</code>。</p><h3 id=构建多腿期权组合>构建多腿期权组合</h3><p>如果想要构建多个期权头寸的组合策略，例如卖出跨式或铁鹰策略，可以使用 <code>multi_plotter()</code> 函数。</p><h4 id=示例-1卖出跨式策略>示例 1：卖出跨式策略</h4><p>卖出跨式策略包括卖出略微虚值的看涨期权和看跌期权。</p><p>在这个例子中，假设基础资产的现价为 100 元，交易者卖出了行权价分别为 110 元和 95 元的看涨期权和看跌期权。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>op_1 <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;op_type&#39;</span>:<span style=color:#e6db74>&#39;c&#39;</span>,<span style=color:#e6db74>&#39;strike&#39;</span>:<span style=color:#ae81ff>110</span>,<span style=color:#e6db74>&#39;tr_type&#39;</span>:<span style=color:#e6db74>&#39;s&#39;</span>,<span style=color:#e6db74>&#39;op_pr&#39;</span>:<span style=color:#ae81ff>2</span>}
</span></span><span style=display:flex><span>op_2 <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;op_type&#39;</span>:<span style=color:#e6db74>&#39;p&#39;</span>,<span style=color:#e6db74>&#39;strike&#39;</span>:<span style=color:#ae81ff>95</span>,<span style=color:#e6db74>&#39;tr_type&#39;</span>:<span style=color:#e6db74>&#39;s&#39;</span>,<span style=color:#e6db74>&#39;op_pr&#39;</span>:<span style=color:#ae81ff>6</span>}
</span></span><span style=display:flex><span>op<span style=color:#f92672>.</span>multi_plotter(spot<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>, op_list<span style=color:#f92672>=</span>[op_1,op_2])
</span></span></code></pre></td></tr></table></div></div><p>如下图：</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2024-09/2024-09-09-visualizing-option-strategy-04.png alt></p><p>图中即展示了单腿，也展示了组合的收益曲线。</p><h4 id=示例-2铁鹰策略>示例 2：铁鹰策略</h4><p>更复杂的策略，如铁鹰策略，它结合了两个看涨期权和两个看跌期权。</p><p>假设某只股票当前价格为 5000 元，交易者卖出行权价为 5100 元的看涨期权，同时买入行权价为 5200 元的看涨期权；同时，卖出行权价为 4900 元的看跌期权，买入行权价为 4800 元的看跌期权。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>op1<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;op_type&#39;</span>: <span style=color:#e6db74>&#39;c&#39;</span>, <span style=color:#e6db74>&#39;strike&#39;</span>: <span style=color:#ae81ff>5100</span>, <span style=color:#e6db74>&#39;tr_type&#39;</span>: <span style=color:#e6db74>&#39;s&#39;</span>, <span style=color:#e6db74>&#39;op_pr&#39;</span>: <span style=color:#ae81ff>120</span>}
</span></span><span style=display:flex><span>op2<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;op_type&#39;</span>: <span style=color:#e6db74>&#39;c&#39;</span>, <span style=color:#e6db74>&#39;strike&#39;</span>: <span style=color:#ae81ff>5200</span>, <span style=color:#e6db74>&#39;tr_type&#39;</span>: <span style=color:#e6db74>&#39;b&#39;</span>, <span style=color:#e6db74>&#39;op_pr&#39;</span>: <span style=color:#ae81ff>80</span>}
</span></span><span style=display:flex><span>op3<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;op_type&#39;</span>: <span style=color:#e6db74>&#39;p&#39;</span>, <span style=color:#e6db74>&#39;strike&#39;</span>: <span style=color:#ae81ff>4900</span>, <span style=color:#e6db74>&#39;tr_type&#39;</span>: <span style=color:#e6db74>&#39;s&#39;</span>, <span style=color:#e6db74>&#39;op_pr&#39;</span>: <span style=color:#ae81ff>150</span>}
</span></span><span style=display:flex><span>op4<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;op_type&#39;</span>: <span style=color:#e6db74>&#39;p&#39;</span>, <span style=color:#e6db74>&#39;strike&#39;</span>: <span style=color:#ae81ff>4800</span>, <span style=color:#e6db74>&#39;tr_type&#39;</span>: <span style=color:#e6db74>&#39;b&#39;</span>, <span style=color:#e6db74>&#39;op_pr&#39;</span>: <span style=color:#ae81ff>100</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>op_list<span style=color:#f92672>=</span>[op1, op2, op3, op4]
</span></span><span style=display:flex><span>op<span style=color:#f92672>.</span>multi_plotter(spot<span style=color:#f92672>=</span><span style=color:#ae81ff>5000</span>,spot_range<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>, op_list<span style=color:#f92672>=</span>op_list)
</span></span></code></pre></td></tr></table></div></div><p>如下图所示：</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2024-09/2024-09-09-visualizing-option-strategy-05-v1.png alt></p><p>这个策略适用于对基础资产价格波动不大的市场，在有限的风险下捕捉有限的利润。</p><h2 id=最后>最后</h2><p>通过 Opstrat 工具包，我们可以快速直观地构建各种期权策略的收益图，无论是简单的单腿期权，还是复杂的多腿期权组合。这提高了我们的分析效率，助我们理解期权交易的风险与收益。</p><div>本文来源于 <a href=https://www.poloxue.com>POLOXUE's BLOG</a>，地址： <a href=https://www.poloxue.com/posts/2024-09-09-visualizing-option-strategy-using-python/>Python 三方库 Opstrat 绘制收益图加深期权策略理解</a><hr class=footer-separator><div class=tags></div><div class=back><a href=https://www.poloxue.com/><span aria-hidden=true>← Back</span></a></div><div class=back></div></div><div class=post>欢迎关注我的公众号：<img style=width:85% src=https://cdn.jsdelivr.net/gh/poloxue/images@main/wechat.png><div class=utterances></div><script src=https://utteranc.es/client.js repo=poloxue/blog issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div><div class="footer wrapper"><nav class=nav><div>2024 Polo Xue All rights reserved</div></nav></div><script>feather.replace()</script></body></html>