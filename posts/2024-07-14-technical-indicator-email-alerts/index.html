<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Python 实现技术指标邮件告警通知 - POLOXUE's BLOG</title><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="Python 实现技术指标邮件告警通知"><meta itemprop=description content="在交易中，如果你有一套人工配合机器人的交易思路，即希望人工确认而不直接下单，那么及时获取关键位置的通知信息，如一些特征明显的技术指标的告警信息，是非常重要的。"><meta itemprop=datePublished content="2024-07-14T18:53:16+08:00"><meta itemprop=dateModified content="2024-07-14T18:53:16+08:00"><meta itemprop=wordCount content="537"><meta itemprop=keywords content><meta property="og:title" content="Python 实现技术指标邮件告警通知"><meta property="og:description" content="在交易中，如果你有一套人工配合机器人的交易思路，即希望人工确认而不直接下单，那么及时获取关键位置的通知信息，如一些特征明显的技术指标的告警信息，是非常重要的。"><meta property="og:type" content="article"><meta property="og:url" content="https://www.poloxue.com/posts/2024-07-14-technical-indicator-email-alerts/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-07-14T18:53:16+08:00"><meta property="article:modified_time" content="2024-07-14T18:53:16+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Python 实现技术指标邮件告警通知"><meta name=twitter:description content="在交易中，如果你有一套人工配合机器人的交易思路，即希望人工确认而不直接下单，那么及时获取关键位置的通知信息，如一些特征明显的技术指标的告警信息，是非常重要的。"><script data-goatcounter=https://poloxue.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/main.css><link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/extra.css><link id=dark-scheme rel=stylesheet type=text/css href=https://www.poloxue.com/css/dark.css><script src=https://www.poloxue.com/js/feather.min.js></script>
<script src=https://www.poloxue.com/js/main.js></script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7019080091542951" crossorigin=anonymous></script></head><body><div class="container-wide wrapper"><div class=header><div class=avatar><a href=https://www.poloxue.com/><img src=/avatar.png alt="POLOXUE's BLOG"></a></div><h1 class=site-title><a href=https://www.poloxue.com/>POLOXUE's BLOG</a></h1><div class=site-description><nav class="nav social"><ul class=flat><li><a href=https://github.com/poloxue/ title=Github><i data-feather=github></i></a></li><li><a href=/posts/index.xml title=RSS><i data-feather=rss></i></a></li><li><a href=/ title=Wechat><i data-feather=message-circle></i></a></li><span class=scheme-toggle><a href=# id=scheme-toggle></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>首页</a></li><li><a href=/posts>文章列表</a></li><li><a href=/tags>分类标签</a></li><li><a href=/about/>关于我</a></li></ul></nav></div><div class=article-nav id=article-nav-id><div class=post><div class=post-header><div class=meta><div class=date><span class=day>14</span>
<span class=rest>Jul 2024</span></div></div><div class=matter><h1 class=title>Python 实现技术指标邮件告警通知</h1></div></div><aside class="show-on-mobile toc" id=static-toc><header><h3>Contents</h3></header><nav id=TableOfContents><ol><li><a href=#数据下载>数据下载</a></li><li><a href=#安装-ta-lib-库>安装 TA-Lib 库</a></li><li><a href=#指标计算与告警>指标计算与告警</a></li><li><a href=#发送告警信息>发送告警信息</a><ol><li><a href=#示例项目>示例项目</a></li></ol></li></ol></nav></aside><p>在交易中，如果你有一套人工配合机器人的交易思路，即希望人工确认而不直接下单，那么及时获取关键位置的通知信息，如一些特征明显的技术指标的告警信息，是非常重要的。</p><p>市面上有不少的付费软件支持这个能力，如果你可以使用 TradingView，它的免费版也可以做到，缺点是缺少国内期货品种。我是不想花钱的，秉承着自己动手，丰衣足食，毕竟小散户不是大机构。</p><p>本文将基于开源数据方案，通过 Python 一套免费的方案，编写指标告警并将其发送到邮件。我将利用 akshare 获取历史行情数据，使用 TA-Lib 计算技术指标。</p><p>接下来将按照这个流程逐步展开介绍。</p><h2 id=数据下载>数据下载</h2><p>在上一篇文章中，我们介绍了如何使用 akshare 下载国内期货、股票和指数的历史行情。假设，我们已经下载了数据，将其存储在一个 DataFrame 中。</p><p>如下是上证指数 000001 的数据下载，我们可直接使用上篇文章的 history_bars 方法，并将数据保存到 <code>index_000001.csv</code> 文件中。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 下载上证指数的历史行情数据</span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> history_bars(symbol<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;000001&#34;</span>, length<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>df<span style=color:#f92672>.</span>to_csv(<span style=color:#e6db74>&#34;index_000001.csv&#34;</span>, index<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span></code></pre></td></tr></table></div></div><p>我提前下载行情是为了防止重复调用产生可能的网络问题，把行情查询和指标计算分离，提高报警程序稳定性。</p><h2 id=安装-ta-lib-库>安装 TA-Lib 库</h2><p>现在可以开始计算指标了。</p><p>python 的指标计算库有如 talib、pandas-ta、ta 等等，其中 talib 最出名，支持超过 150 中技术指标，由 C 语言实现，性能更高。我将使用的就是 talib。</p><p>TA-Lib 的安装要提前安装依赖的动态库，参考 <a href=https://ta-lib.github.io/ta-lib-python/install.html>TA-Lib 官方文档</a>。我简单展开说说不同操作系统的安装方法吧。</p><p><strong>macOS</strong></p><p>macOS 上可通过 Homebrew 安装：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>brew install ta-lib
</span></span></code></pre></td></tr></table></div></div><p><strong>Linux</strong></p><p>Linux 上要手动编译安装，提前下载 <a href=https://prdownloads.sourceforge.net/ta-lib/ta-lib-0.4.0-src.tar.gz>ta-lib-0.4.0-src.tar.gz</a>，并执行如下命令：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ wget https://prdownloads.sourceforge.net/ta-lib/ta-lib-0.4.0-src.tar.gz
</span></span><span style=display:flex><span>$ tar zxvf ta-lib-0.4.0-src.tar.gz
</span></span><span style=display:flex><span>$ cd ta-lib/
</span></span><span style=display:flex><span>$ ./configure --prefix<span style=color:#f92672>=</span>/usr
</span></span><span style=display:flex><span>$ make
</span></span><span style=display:flex><span>$ sudo make install
</span></span></code></pre></td></tr></table></div></div><p><strong>Window</strong></p><p>Windows 上下载 <a href=https://prdownloads.sourceforge.net/ta-lib/ta-lib-0.4.0-msvc.zip>ta-lib-0.4.0-msvc.zip</a> 文件，并将其解压到 <code>C:\ta-lib</code>。</p><p>我记得 windows 上也是可以直接下载 wheel 文件。</p><p><strong>pip install</strong></p><p>在依赖库安装完成后，如下命令 pip 安装 TA-Lib 即可：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pip install ta-lib
</span></span></code></pre></td></tr></table></div></div><h2 id=指标计算与告警>指标计算与告警</h2><p>我们开始计算指标和告警规则，我会用 RSI 和布林带这两个耳熟能详的指标，基于它们配置一些报警规则。</p><p>首先加载 <code>index_000001.csv</code> 中保存的数据，进行清洗和预处理，便于指标计算。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#34;index_000001.csv&#34;</span>)
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;date&#39;</span>] <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>to_datetime(df[<span style=color:#e6db74>&#39;date&#39;</span>])
</span></span><span style=display:flex><span>df<span style=color:#f92672>.</span>set_index(<span style=color:#e6db74>&#39;date&#39;</span>, inplace<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span></code></pre></td></tr></table></div></div><p>接下来，使用 TA-Lib 计算 RSI 和布林带（BollingerBands）。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> talib
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 计算 RSI</span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;RSI&#39;</span>] <span style=color:#f92672>=</span> talib<span style=color:#f92672>.</span>RSI(df[<span style=color:#e6db74>&#39;close&#39;</span>], timeperiod<span style=color:#f92672>=</span><span style=color:#ae81ff>14</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 计算布林带</span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;upperband&#39;</span>], df[<span style=color:#e6db74>&#39;middleband&#39;</span>], df[<span style=color:#e6db74>&#39;lowerband&#39;</span>] <span style=color:#f92672>=</span> talib<span style=color:#f92672>.</span>BBANDS(df[<span style=color:#e6db74>&#39;close&#39;</span>], timeperiod<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>)
</span></span></code></pre></td></tr></table></div></div><p>如果想了解更多技术指标的计算方法，可直接查看 TA-Lib 的文档，它还可以计算其他常见的技术指标，例如 MACD 和移动平均线。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 计算 MACD</span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;macd&#39;</span>], df[<span style=color:#e6db74>&#39;macdsignal&#39;</span>], df[<span style=color:#e6db74>&#39;macdhist&#39;</span>] <span style=color:#f92672>=</span> talib<span style=color:#f92672>.</span>MACD(df[<span style=color:#e6db74>&#39;close&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 计算移动平均线</span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;SMA_50&#39;</span>] <span style=color:#f92672>=</span> talib<span style=color:#f92672>.</span>SMA(df[<span style=color:#e6db74>&#39;close&#39;</span>], timeperiod<span style=color:#f92672>=</span><span style=color:#ae81ff>50</span>)
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;SMA_200&#39;</span>] <span style=color:#f92672>=</span> talib<span style=color:#f92672>.</span>SMA(df[<span style=color:#e6db74>&#39;close&#39;</span>], timeperiod<span style=color:#f92672>=</span><span style=color:#ae81ff>200</span>)
</span></span></code></pre></td></tr></table></div></div><p>基本在市面上常见的指数指标在 TA-Lib 中都可以找到，查看<a href=https://ta-lib.github.io/ta-lib-python/funcs.html>它的指标函数</a>。</p><p>有了指标后，开始定义报警条件。我为了演示，定义 RSI 和布林带的告警条件为常用的超买信号，即 RSI 大于 70 和收盘价大于布林带上轨为报警条件。</p><p>基于如下代码：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>rsi_alerts <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;RSI&#39;</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>70</span>  <span style=color:#75715e># RSI 超过 70</span>
</span></span><span style=display:flex><span>bollinger_alerts <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;close&#39;</span>] <span style=color:#f92672>&gt;</span> df[<span style=color:#e6db74>&#39;upperband&#39;</span>]  <span style=color:#75715e># 收盘价超过上轨</span>
</span></span></code></pre></td></tr></table></div></div><p>有了两条告警后，设置为每天收盘后运行，决定第二天是否交易。也或许，你希望收盘临近时检测，从而在收盘前提前入场，不过这个前提是要能获取到实时行情，akshare 中也提供了这样的接口，可查看它的 <a href=https://akshare.akfamily.xyz/tutorial.html>接口列表</a> 查找。</p><h2 id=发送告警信息>发送告警信息</h2><p>告警规则有了，将信息发送到我们就变得非常重要了，我选择的发送到邮件。我将其封装消息发送函数。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>send_email(title, body, send_to)
</span></span></code></pre></td></tr></table></div></div><p>使用 Python 的 smtplib 库可以轻松发送邮件。当然，你需要提前开始 smtp 支持，如 163 邮箱，登录到邮箱的设置页 -> POP3/SMTP/IMAP，启用 POP3/SMTP 服务，会得到一串授权码，而 163 的 smtp 的地址和 SSL 的端口分别是smtp.163.com 和 465。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> smtplib
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> email.mime.text <span style=color:#f92672>import</span> MIMEText
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>send_email</span>(subject, body, to_email):
</span></span><span style=display:flex><span>    from_email <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;your_email@163.com&#39;</span>
</span></span><span style=display:flex><span>    from_password <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;your_email_password&#39;</span> <span style=color:#75715e># smtp 的授权码</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    msg <span style=color:#f92672>=</span> MIMEText(body)
</span></span><span style=display:flex><span>    msg[<span style=color:#e6db74>&#39;Subject&#39;</span>] <span style=color:#f92672>=</span> subject
</span></span><span style=display:flex><span>    msg[<span style=color:#e6db74>&#39;From&#39;</span>] <span style=color:#f92672>=</span> from_email
</span></span><span style=display:flex><span>    msg[<span style=color:#e6db74>&#39;To&#39;</span>] <span style=color:#f92672>=</span> to_email
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    server <span style=color:#f92672>=</span> smtplib<span style=color:#f92672>.</span>SMTP_SSL(<span style=color:#e6db74>&#39;smtp.163.com&#39;</span>, <span style=color:#ae81ff>465</span>)
</span></span><span style=display:flex><span>    server<span style=color:#f92672>.</span>login(from_email, from_password)
</span></span><span style=display:flex><span>    server<span style=color:#f92672>.</span>sendmail(from_email, [to_email], msg<span style=color:#f92672>.</span>as_string())
</span></span><span style=display:flex><span>    server<span style=color:#f92672>.</span>quit()
</span></span></code></pre></td></tr></table></div></div><p>只要一行代码即可测试，如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>send_email(<span style=color:#e6db74>&#34;你好&#34;</span>, <span style=color:#e6db74>&#34;测试邮件&#34;</span>, <span style=color:#e6db74>&#34;to_email@163.com&#34;</span>)
</span></span></code></pre></td></tr></table></div></div><p>万事具备，我们现在可以发送告警信息了。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>alerts <span style=color:#f92672>=</span> rsi_alerts <span style=color:#f92672>|</span> bollinger_alerts
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> alerts<span style=color:#f92672>.</span>iloc[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>50</span>:
</span></span><span style=display:flex><span>    last_close <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#34;close&#34;</span>]<span style=color:#f92672>.</span>iloc[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    last_rsi <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#34;RSI&#34;</span>]<span style=color:#f92672>.</span>iloc[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    last_upperband <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#34;upperband&#34;</span>]<span style=color:#f92672>.</span>iloc[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    message <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;告警！RSI：</span><span style=color:#e6db74>{</span>last_rsi<span style=color:#e6db74>}</span><span style=color:#e6db74>，收盘价：</span><span style=color:#e6db74>{</span>last_close<span style=color:#e6db74>}</span><span style=color:#e6db74>，上轨：</span><span style=color:#e6db74>{</span>last_upperband<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    send_email(<span style=color:#e6db74>&#34;告警！&#34;</span>, message, <span style=color:#e6db74>&#34;poloxue123@gmail.com&#34;</span>)
</span></span></code></pre></td></tr></table></div></div><p>实现的逻辑还是非常简单的，当然告警的条件要视你的交易思路来实现。</p><h3 id=示例项目>示例项目</h3><p>以下是一个完整代码，将上面的过程整合到了一起、指标计算到发送告警信息的全过程：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> talib
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> smtplib
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> email.mime.text <span style=color:#f92672>import</span> MIMEText
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#34;index_000001.csv&#34;</span>)
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#34;date&#34;</span>] <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>to_datetime(df[<span style=color:#e6db74>&#34;date&#34;</span>])
</span></span><span style=display:flex><span>df<span style=color:#f92672>.</span>set_index(<span style=color:#e6db74>&#34;date&#34;</span>, inplace<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 计算 RSI</span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#34;RSI&#34;</span>] <span style=color:#f92672>=</span> talib<span style=color:#f92672>.</span>RSI(df[<span style=color:#e6db74>&#34;close&#34;</span>], timeperiod<span style=color:#f92672>=</span><span style=color:#ae81ff>14</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 计算布林带</span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#34;upperband&#34;</span>], df[<span style=color:#e6db74>&#34;middleband&#34;</span>], df[<span style=color:#e6db74>&#34;lowerband&#34;</span>] <span style=color:#f92672>=</span> talib<span style=color:#f92672>.</span>BBANDS(
</span></span><span style=display:flex><span>    df[<span style=color:#e6db74>&#34;close&#34;</span>], timeperiod<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 计算 MACD</span>
</span></span><span style=display:flex><span><span style=color:#75715e># df[&#39;macd&#39;], df[&#39;macdsignal&#39;], df[&#39;macdhist&#39;] = talib.MACD(df[&#39;close&#39;])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 计算移动平均线</span>
</span></span><span style=display:flex><span><span style=color:#75715e># df[&#39;SMA_50&#39;] = talib.SMA(df[&#39;close&#39;], timeperiod=50)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># df[&#39;SMA_200&#39;] = talib.SMA(df[&#39;close&#39;], timeperiod=200)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rsi_alerts <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#34;RSI&#34;</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>70</span>  <span style=color:#75715e># RSI 超过 70</span>
</span></span><span style=display:flex><span>bollinger_alerts <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#34;close&#34;</span>] <span style=color:#f92672>&gt;</span> df[<span style=color:#e6db74>&#34;upperband&#34;</span>]  <span style=color:#75715e># 收盘价超过上轨</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PASSWORD <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;your_email_password&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>send_email</span>(subject, body, to_email):
</span></span><span style=display:flex><span>    from_email <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;your_email@163.com&#34;</span>
</span></span><span style=display:flex><span>    from_password <span style=color:#f92672>=</span> PASSWORD
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    msg <span style=color:#f92672>=</span> MIMEText(body)
</span></span><span style=display:flex><span>    msg[<span style=color:#e6db74>&#34;Subject&#34;</span>] <span style=color:#f92672>=</span> subject
</span></span><span style=display:flex><span>    msg[<span style=color:#e6db74>&#34;From&#34;</span>] <span style=color:#f92672>=</span> from_email
</span></span><span style=display:flex><span>    msg[<span style=color:#e6db74>&#34;To&#34;</span>] <span style=color:#f92672>=</span> to_email
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    server <span style=color:#f92672>=</span> smtplib<span style=color:#f92672>.</span>SMTP_SSL(<span style=color:#e6db74>&#34;smtp.163.com&#34;</span>, <span style=color:#ae81ff>465</span>)
</span></span><span style=display:flex><span>    server<span style=color:#f92672>.</span>login(from_email, from_password)
</span></span><span style=display:flex><span>    server<span style=color:#f92672>.</span>sendmail(from_email, [to_email], msg<span style=color:#f92672>.</span>as_string())
</span></span><span style=display:flex><span>    server<span style=color:#f92672>.</span>quit()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>alerts <span style=color:#f92672>=</span> rsi_alerts <span style=color:#f92672>|</span> bollinger_alerts
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> alerts<span style=color:#f92672>.</span>iloc[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>50</span>:
</span></span><span style=display:flex><span>    last_close <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#34;close&#34;</span>]<span style=color:#f92672>.</span>iloc[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    last_rsi <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#34;RSI&#34;</span>]<span style=color:#f92672>.</span>iloc[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    last_upperband <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#34;upperband&#34;</span>]<span style=color:#f92672>.</span>iloc[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    message <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;告警！RSI：</span><span style=color:#e6db74>{</span>last_rsi<span style=color:#e6db74>}</span><span style=color:#e6db74>，收盘价：</span><span style=color:#e6db74>{</span>last_close<span style=color:#e6db74>}</span><span style=color:#e6db74>，上轨：</span><span style=color:#e6db74>{</span>last_upperband<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    send_email(<span style=color:#e6db74>&#34;告警！&#34;</span>, message, <span style=color:#e6db74>&#34;to_email@163.com&#34;</span>)
</span></span></code></pre></td></tr></table></div></div><p>注意将以上的邮件地址和授权码替换为真实的即可。现在，我们就可以实现对基于技术指标的告警配置，还能通过邮件接收告警信息。</p><p>最后，希望这篇文章对你有所帮助。如果有任何问题或建议，欢迎留言讨论。</p></div><nav class="hide-on-mobile section-nav"><nav id=TableOfContents><ol><li><a href=#数据下载>数据下载</a></li><li><a href=#安装-ta-lib-库>安装 TA-Lib 库</a></li><li><a href=#指标计算与告警>指标计算与告警</a></li><li><a href=#发送告警信息>发送告警信息</a><ol><li><a href=#示例项目>示例项目</a></li></ol></li></ol></nav></nav></div><div class=post><hr class=footer-separator><div class=tags></div><div class=back><a href=https://www.poloxue.com/><span aria-hidden=true>← Back</span></a></div><div class=back></div></div><div class=post><img style=width:85% src=https://cdn.jsdelivr.net/gh/poloxue/images@main/wechat.png><div class=utterances></div><script src=https://utteranc.es/client.js repo=poloxue/blog issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div><div class="footer wrapper"><nav class=nav><div>2024 Polo Xue All rights reserved</div></nav></div><script>feather.replace()</script><script>var enableTruncate=!0,filterDepth=!1;const MAX_DEPTH=9;window.addEventListener("DOMContentLoaded",()=>{const e=new IntersectionObserver(e=>{e.reverse().forEach(e=>{const n=e.target.getAttribute("id");if(e.intersectionRatio>0){var t=document.querySelectorAll(`nav li a[href="#${n}"]`);t!=null&&t.forEach(e=>{if(e!=null){var t=getDepth(e.parentElement);filterDepth&&t<=MAX_DEPTH&&(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))}else filterDepth||(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))})}})});document.querySelectorAll("h1[id],h2[id],h3[id],h4[id]").forEach(t=>{e.observe(t)})});function isVisible(e){if(!(e instanceof Element))return!1;const n=getComputedStyle(e);if(n.display==="none")return!1;if(n.visibility!=="visible")return!1;if(n.opacity<.1)return!1;if(e.offsetWidth+e.offsetHeight+e.getBoundingClientRect().height+e.getBoundingClientRect().width===0)return!1;const t={x:e.getBoundingClientRect().left+e.offsetWidth/2,y:e.getBoundingClientRect().top+e.offsetHeight/2};if(t.x<0)return!1;if(t.x>(document.documentElement.clientWidth||window.innerWidth))return!1;if(t.y<0)return!1;if(t.y>(document.documentElement.clientHeight||window.innerHeight))return!1;let s=document.elementFromPoint(t.x,t.y);do if(s===e)return!0;while(s=s.parentNode)return!1}function clearActiveStatesInTableOfContents(){document.querySelectorAll("nav li").forEach(e=>{e.classList.remove("active")})}function getDepth(e){for(var t=0;e!==null&&e.tagName.toLowerCase()!=="ul";)t++,e=e.parentElement;return t}function navItems(){var e=document.querySelectorAll("nav nav li a");return Array.from(e).filter(e=>e.href!=null&&e.hash.startsWith("#"))}function lasItemInNavBarVisible(){var e=navItems().slice(-1)[0];return isVisible(e)}document.addEventListener("DOMContentLoaded",function(){if(!enableTruncate)return;var e=navItems();console.log(e),lasItemInNavBarVisible()||(filterDepth=!0,e.forEach(function(e){var t=getDepth(e.parentElement);t>MAX_DEPTH&&e.parentElement.classList.add("depth-nested")}))})</script></body></html>