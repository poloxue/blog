<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>我的终端环境：高效 shell 命令（二）之文件查找与内容搜索 - fd ripgrep fzf - POLOXUE's BLOG</title><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="我的终端环境：高效 shell 命令（二）之文件查找与内容搜索 - fd ripgrep fzf"><meta itemprop=description content="本文将介绍一些高效的查找搜索命令，分别是 fd、ripgrep 与 fzf，提升命令内容的查找效率"><meta itemprop=datePublished content="2023-10-30T20:13:53+08:00"><meta itemprop=dateModified content="2023-10-30T20:13:53+08:00"><meta itemprop=wordCount content="584"><meta itemprop=keywords content="zsh,"><meta property="og:title" content="我的终端环境：高效 shell 命令（二）之文件查找与内容搜索 - fd ripgrep fzf"><meta property="og:description" content="本文将介绍一些高效的查找搜索命令，分别是 fd、ripgrep 与 fzf，提升命令内容的查找效率"><meta property="og:type" content="article"><meta property="og:url" content="https://www.poloxue.com/posts/2023-10-30-high-productivity-shell-commands-part2/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-30T20:13:53+08:00"><meta property="article:modified_time" content="2023-10-30T20:13:53+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="我的终端环境：高效 shell 命令（二）之文件查找与内容搜索 - fd ripgrep fzf"><meta name=twitter:description content="本文将介绍一些高效的查找搜索命令，分别是 fd、ripgrep 与 fzf，提升命令内容的查找效率"><script data-goatcounter=https://poloxue.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/main.css><link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/extra.css><link id=dark-scheme rel=stylesheet type=text/css href=https://www.poloxue.com/css/dark.css><script src=https://www.poloxue.com/js/feather.min.js></script>
<script src=https://www.poloxue.com/js/main.js></script></head><body><div class="container-wide wrapper"><div class=header><div class=avatar><a href=https://www.poloxue.com/><img src=/avatar.png alt="POLOXUE's BLOG"></a></div><h1 class=site-title><a href=https://www.poloxue.com/>POLOXUE's BLOG</a></h1><div class=site-description><nav class="nav social"><ul class=flat><li><a href=https://github.com/poloxue/ title=Github><i data-feather=github></i></a></li><li><a href=/posts/index.xml title=RSS><i data-feather=rss></i></a></li><span class=scheme-toggle><a href=# id=scheme-toggle></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>HOME</a></li><li><a href=/posts>POSTS</a></li><li><a href=/tags>TAGS</a></li><li><a href=/courses>COURSES</a></li><li><a href=/about/>ABOUT</a></li></ul></nav></div><div class=article-nav id=article-nav-id><div class=post><div class=post-header><div class=meta><div class=date><span class=day>30</span>
<span class=rest>Oct 2023</span></div></div><div class=matter><h1 class=title>我的终端环境：高效 shell 命令（二）之文件查找与内容搜索 - fd ripgrep fzf</h1></div></div><aside class="show-on-mobile toc" id=static-toc><header><h3>Contents</h3></header><nav id=TableOfContents><ol><li><a href=#fdhttpsgithubcomsharkdpfd><a href=https://github.com/sharkdp/fd>fd</a></a><ol><li><a href=#安装>安装</a></li><li><a href=#使用>使用</a></li><li><a href=#性能>性能</a></li></ol></li><li><a href=#ripgrephttpsgithubcomburntsushiripgrep><a href=https://github.com/BurntSushi/ripgrep>ripgrep</a></a><ol><li><a href=#安装-1>安装</a></li><li><a href=#使用-1>使用：</a></li><li><a href=#配置>配置</a></li></ol></li><li><a href=#fzfhttpsgithubcomjunegunnfzf><a href=https://github.com/junegunn/fzf>fzf</a></a><ol><li><a href=#安装-2>安装</a></li><li><a href=#使用-2>使用</a></li></ol></li><li><a href=#总结>总结</a></li></ol></nav></aside><p><div id=video-1699370569 style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden></div><script>var r=new XMLHttpRequest;r.addEventListener("load",function(){container=document.getElementById("video-1699370569"),data=JSON.parse(this.responseText),bb_id="962959372",yt_id="CcnmD_dHsnk",data.country_code=="CN"||yt_id==0&&bb_id!=0?container.innerHTML='<iframe src="https://player.bilibili.com/player.html?aid='+bb_id+'&amp;page=1" style="position:absolute;top:0;left:0;width:100%;height:100%;border:0;" allowfullscreen title="Bilibili Video" ></iframe > ':yt_id!=0&&(container.innerHTML='<iframe src="https://www.youtube.com/embed/'+yt_id+'"style="position:absolute;top:0;left:0;width:100%;height:100%; border:0;" title="YouTube video player" frameborder="0" allow="accelerometer;autoplay;clipboard-write;encrypted-media;gyroscope;picture-in-picture;web-share"allowfullscreen></iframe>')}),r.open("GET","https://ipapi.co/json/"),r.send()</script>本文将介绍一些用于高效查找和搜索的命令，它们分别是 fd、ripgrep 与 fzf。相对于常用的 grep 和 find，这些命令在性能有大部分提升，而且，它们的使用方式上更符合人性。</p><p>如下是这几个命令的简单说明：</p><ul><li><a href=https://github.com/sharkdp/fd>fd</a>，目录与文件搜索命令，比默认 find 更易于使用，而且查找速度上更快；</li><li><a href=https://github.com/BurntSushi/ripgrep>ripgrep</a>，用于高效的内搜索容；</li><li><a href=https://github.com/junegunn/fzf>fzf</a>，是一款命令行交互式的模糊搜索工具，可与其他命令进行结合，提高使用体验；</li></ul><p>其中的 fd 与 ripgrep 是用 rust 编写，性能上完虐传统的 find 与 grep。</p><blockquote><p>系列阅读：</p><ul><li><a href=https://www.poloxue.com/posts/2023-09-25-install-iterm2-as-my-developing-environment/>我的终端环境：iTerm2 的安装与体验</a></li><li><a href=https://poloxue.com/posts/2023-10-16-zsh-themes-and-plugins/>我的终端环境：zsh 安装与主题，推荐 7 个提升效率的 zsh 插件</a></li><li><a href=https://www.poloxue.com/posts/2023-10-19-zsh-6-powerful-plugins/>我的终端环境：6 个强大的 zsh 插件</a></li><li><a href=https://www.poloxue.com/posts/2023-10-20-zsh-theme-powerlevel10k/>我的终端环境：与众不同的 zsh 主题 - powerlevel10k</a></li><li><a href=https://www.poloxue.com/posts/2023-10-28-high-productivity-shell-commands-part1/>我的终端环境：高效 shell 命令（一）之目录文件命令 - exa、zoxide 与 bat</a></li><li><a href=https://www.poloxue.com/posts/2023-10-28-high-productivity-shell-commands-part2/>我的终端环境：高效 shell 命令（二）之高效查找与搜索 - fd ripgrep fzf</a></li><li><a href=https://www.poloxue.com/posts/2023-11-02-high-productivity-shell-commands-part3/>我的终端环境：高效 shell 命令（三）之提效 web 开发 - entr httpie jq</a></li></ul><p>更多待续&mldr;</p></blockquote><h2 id=fdhttpsgithubcomsharkdpfd><a href=https://github.com/sharkdp/fd>fd</a></h2><p>fd 是一款文件查找的命令，可用于替换默认的 find，它在体验上更加友好，且查询效率极高。</p><h3 id=安装>安装</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>brew install fd
</span></span></code></pre></td></tr></table></div></div><h3 id=使用>使用</h3><p>案例一 简单搜索 - fd pattern</p><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-01.gif><p>案例二 正则查询 - fd regex_exp</p><p>如查找包含文件名中包含日期的文件：</p><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-02.gif><p>或者查找所有的 go 代码文件。</p><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-03.gif><p>这个表达式更加正确的表述是 fd <code>.*\.go$</code>，超出所有以 <code>.go</code> 结尾的文件。</p><p>案例三 通配符</p><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-04.gif><p>案例四 指定类型</p><p>前面的查找 go 文件的方式，无论是通过正则还是通配符，都相对繁琐一点，可直接通过 fd -e go pattern 的模式直接寻找指定扩展的文件。</p><p>如下示例查找以 <code>.py</code> 为扩展且文件名包含 <code>moving_average</code> 的文件：</p><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-05.gif><p>如果无 patern，效果则是查找所有的 <code>.py</code> 的文件，如下所示：</p><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-07.gif><p>案例五 隐藏文件和 <code>.gitinogre</code></p><p>默认情况下，fd 的查找结果不包含隐藏文件，可通过 -H 选项启用：</p><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-06.png><p>从上图可以看出，其中包含了不少 .git/config 文件，而 .git 是隐藏文件。</p><p>查询范围包含 gitignore</p><p>同样，除了默认忽略 hidden 文件，fd 还会忽略 .gitignore 中的文件，选项 -I 即可查找包含在 <code>.gitinogre/.fdignore/.ignore</code> 的文件，形如 <code>fd -I pattern</code>。</p><p>其他示例</p><table><thead><tr><th>案例</th><th>命令</th><th>说明</th></tr></thead><tbody><tr><td>忽略大小写</td><td>fd -i readme.md</td><td>包含 readme.md 和 README.md</td></tr><tr><td>大小写的 smartcase 模式</td><td>fd -s readme.md</td><td>包含 readme.md 和 README.md</td></tr><tr><td>&mdash;</td><td>fd -s README.md</td><td>只包含 README.md</td></tr><tr><td>查找结果显示详细信息</td><td>fd -l .go</td><td>查询结果显示文件详情</td></tr><tr><td>大小过滤</td><td>fd -S +1000k</td><td>查询大小 > 1000k 的文件</td></tr><tr><td>仅查找目录</td><td>fd &ndash;type/-t directory golang</td><td>查询所有目录文件</td></tr><tr><td>查询并执行命令</td><td>fd &ndash;type/-t file -x wc -l</td><td>查询文件并计算行数</td></tr><tr><td>&mdash;</td><td>fd &ndash;type/-t file -X vim</td><td>查询所有文件并用 vim 打开</td></tr></tbody></table><h3 id=性能>性能</h3><p>通过 hyperfine 或 time 命令测试，与 find 进行性能对比，包含所有文件且大小写不敏感搜索。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>hyperfine --warmup <span style=color:#ae81ff>3</span> <span style=color:#e6db74>&#34;find . -iname *.go&#34;</span> <span style=color:#e6db74>&#34;fd -i -g &#39;*.go&#39; -uu&#34;</span>
</span></span></code></pre></td></tr></table></div></div><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/2023-10-30-high-productivity-shell-commands-part2-08.gif><h2 id=ripgrephttpsgithubcomburntsushiripgrep><a href=https://github.com/BurntSushi/ripgrep>ripgrep</a></h2><p>ripgrep 是一款文本搜索命令，功能与 grep 类似；</p><h3 id=安装-1>安装</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>brew install ripgrep
</span></span></code></pre></td></tr></table></div></div><h3 id=使用-1>使用：</h3><p>用法一 默认递归搜索当前目录，如 rg pattern；</p><p>默认高亮显示，对比于 <code>grep --color main . -nR</code> 简洁易用，体验更好。效果如下：</p><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-09.gif><p>用法二 搜索指定目录，rg patern directory</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>rg main ~/Code/golang-examples/
</span></span></code></pre></td></tr></table></div></div><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-10.gif><p>用法三 搜索指定文件，rg pattern filepath</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>rg main ~/Code/golang-examples/main.go
</span></span></code></pre></td></tr></table></div></div><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-11.png><p>用法四 通配符禁用目录</p><p>通过通配符方式，禁用目录递归。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>rg main -g <span style=color:#e6db74>&#39;!/*/*&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>其他还可实现如排除文件：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>rg main -g <span style=color:#e6db74>&#39;!main.go&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>排除文件</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>rg -g <span style=color:#e6db74>&#39;!directory&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>用法五 正则搜索</p><p>通过 <code>-e</code> 选项启用正则表达式搜索，如：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>rg -e <span style=color:#e6db74>&#39;[0-9]{2}:[0-9]{2}&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>用法六 默认过滤</p><p>和 fd 一样，ripgrep 的高效率搜索能力一方面也是因为默认忽略了一些文件，如它忽略隐藏文件以及 .gitgnore .ignore .rgignore 中的文件。禁用 ignore 可通过选项 &ndash;no-ignore 金融即可。而对于隐藏文件，通过 <code>--hidden</code> 即可搜索包含隐藏文件。</p><p>如果希望禁用所有隐藏文件，则可通过 <code>-uuu</code> 实现，如 <code>rg -uuu pattern</code>。</p><p>用法八 大小写敏感：</p><p>默认大小写敏感：rg pattern，可通过 <code>-i</code> 选项忽略大小写：<code>rg -i pattern</code>，或者通过 <code>-S</code> 启用 smartcase 模式，即 <code>rg -S pattern</code>。</p><p>用法九 搜索并替换</p><p>通过 <code>-r</code> 可直接替换搜索结果，但不改变原内容。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>rg main ~/Code/golang-examples r main <span style=color:#75715e># 只替换输出，未修改文件</span>
</span></span></code></pre></td></tr></table></div></div><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-12.png><h3 id=配置>配置</h3><p>配置文件修改 ripgrep 的默认行为，通过设置环境变量 <code>RIPGREP_CONFIG_PATH</code> 执行配置文件。配置文件中的设置方式，和上文介绍的 bat 类似，都是通过 <code>--xxx</code> 选项的形式设置。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span><span style=color:#75715e># Don&#39;t let ripgrep vomit really long lines to my terminal, and show a preview.</span>
</span></span><span style=display:flex><span>--max-columns<span style=color:#f92672>=</span><span style=color:#ae81ff>150</span>
</span></span><span style=display:flex><span>--max-columns-preview
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add my &#39;web&#39; type.</span>
</span></span><span style=display:flex><span>--type-add
</span></span><span style=display:flex><span>web:*.<span style=color:#f92672>{</span>html,css,js<span style=color:#f92672>}</span>*
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Search hidden files / directories (e.g. dotfiles) by default</span>
</span></span><span style=display:flex><span>--hidden
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Using glob patterns to include/exclude files or folders</span>
</span></span><span style=display:flex><span>--glob<span style=color:#f92672>=</span>!.git/*
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># or</span>
</span></span><span style=display:flex><span>--glob
</span></span><span style=display:flex><span>!.git/*
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set the colors.</span>
</span></span><span style=display:flex><span>--colors<span style=color:#f92672>=</span>line:none
</span></span><span style=display:flex><span>--colors<span style=color:#f92672>=</span>line:style:bold
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Because who cares about case!?</span>
</span></span><span style=display:flex><span>--smart-case
</span></span></code></pre></td></tr></table></div></div><p>如希望 ripgrep 默认 smartcase 能力，可将 <code>--smart-case</code> 直接配置到配置文件中。</p><h2 id=fzfhttpsgithubcomjunegunnfzf><a href=https://github.com/junegunn/fzf>fzf</a></h2><p>fzf 全名 fuzzy finder，是一款通用的命令行模糊查找工具。它可与其他命令结合，提升其他命令的使用体验。</p><h3 id=安装-2>安装</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>brew install fzf
</span></span></code></pre></td></tr></table></div></div><h3 id=使用-2>使用</h3><p>用法一 目录搜索</p><p>默认在当前所在目录进入交互式目录文件搜索路径，效果如下所示：</p><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-13.gif><p>支持通过 CTRL+P/N 上下选择，确认搜索结果后，输入 Enter 确认后，它会将输出直接作为输出打印到标准输出。</p><p>用法二 将其他命令输出作为 fzf 的搜索内容；</p><p>除了默认基于当前位置搜索文件目录，fzf 的搜索内容可自定义。如将 <code>one</code>、<code>two</code>、<code>three</code>、<code>four</code> 作为输入，通过 fzf 搜索选择。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>echo <span style=color:#e6db74>&#34;one\ntwo\nthree\nfour&#34;</span> | fzf
</span></span></code></pre></td></tr></table></div></div><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-14.gif><p>如此一来，更过可能就诞生了，如 ls 的文件作为输入：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>ls | fzf
</span></span></code></pre></td></tr></table></div></div><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-15.gif><p>将上面介绍的 fd 的查找结果作为输入：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>fd --type file | fzf
</span></span></code></pre></td></tr></table></div></div><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-16.gif><p>用法三 将搜索结果作为其他命令的输入；</p><p>fzf 的搜索结果如果只是打印到终端，那就太可惜了，可将其其它命令的输入。如下命令：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>vim <span style=color:#e6db74>`</span>fzf<span style=color:#e6db74>`</span>
</span></span></code></pre></td></tr></table></div></div><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-17.gif><p>将 fzf 的搜索结果作为 vim 命令的输入。</p><p>用法四 输入输出，命令组合实现更多可能</p><p>实验到这里，是不是已经发现，fzf 实现更多可能性的能力，形如 <code>command1 | fzf | xargs command2</code>，将 command1 的结果作为 fzf 的搜索来源，将 fzf 的确认结果作为 command2 的输入。</p><p>如上节的 zoxide 快速进入文件能力。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>cd `zoxide query --list {querystring} | fzf`
</span></span></code></pre></td></tr></table></div></div><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-19.gif><p>默认的 <code>zoxide query --list</code> 只记录的是 zoxide 中的历史记录，如想实现全局查询，可替换为类似如下命令：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>cd <span style=color:#e6db74>`</span>fd --type<span style=color:#f92672>=</span>directory | fzf<span style=color:#e6db74>`</span>
</span></span></code></pre></td></tr></table></div></div><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-18.gif><p>如下是一个 cdg 的命令实现，可实现 cd 命令的任意目录的快速交互式搜索：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>alias cdg<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;cd_global() {cd $(fd --type directory $1 $2 | fzf)}; cd_global&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>使用方式形如 <code>cdg pattern directory</code>，在哪一个目录下查询包含 pattern 的目录，确认后即可 cd 进入到这个目录。</p><image src=https://cdn.jsdelivr.net/gh/poloxue/images@latest/./2023-10-30-high-productivity-shell-commands-part2-20.gif><p>说明下，我实际使用下来，这个命令确实很少需要，因为大多数时间我还是在访问我经常使用的目录，默认 zoxide 的能力完全足够使用。</p><h2 id=总结>总结</h2><p>本文介绍了三个与查找搜索相关的命令，分别是用于文件查找的 fd、文本搜索的 ripgrep 及交互式搜索工具 fzf。通过将这几个命令的组合使用，再进一步提升我们的终端使用效率。</p></div><nav class="hide-on-mobile section-nav"><nav id=TableOfContents><ol><li><a href=#fdhttpsgithubcomsharkdpfd><a href=https://github.com/sharkdp/fd>fd</a></a><ol><li><a href=#安装>安装</a></li><li><a href=#使用>使用</a></li><li><a href=#性能>性能</a></li></ol></li><li><a href=#ripgrephttpsgithubcomburntsushiripgrep><a href=https://github.com/BurntSushi/ripgrep>ripgrep</a></a><ol><li><a href=#安装-1>安装</a></li><li><a href=#使用-1>使用：</a></li><li><a href=#配置>配置</a></li></ol></li><li><a href=#fzfhttpsgithubcomjunegunnfzf><a href=https://github.com/junegunn/fzf>fzf</a></a><ol><li><a href=#安装-2>安装</a></li><li><a href=#使用-2>使用</a></li></ol></li><li><a href=#总结>总结</a></li></ol></nav></nav></div><div class=post><hr class=footer-separator><div class=tags><ul class=flat><li class=tag-li><a href=/tags/zsh>zsh</a></li></ul></div><div class=back><a href=https://www.poloxue.com/><span aria-hidden=true>← Back</span></a></div><div class=back></div></div></div><div class="footer wrapper"><nav class=nav><div>2023 Polo Xue All rights reserved</div></nav></div><script>feather.replace()</script><script>var enableTruncate=!0,filterDepth=!1;const MAX_DEPTH=9;window.addEventListener("DOMContentLoaded",()=>{const e=new IntersectionObserver(e=>{e.reverse().forEach(e=>{const n=e.target.getAttribute("id");if(e.intersectionRatio>0){var t=document.querySelectorAll(`nav li a[href="#${n}"]`);t!=null&&t.forEach(e=>{if(e!=null){var t=getDepth(e.parentElement);filterDepth&&t<=MAX_DEPTH&&(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))}else filterDepth||(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))})}})});document.querySelectorAll("h1[id],h2[id],h3[id],h4[id]").forEach(t=>{e.observe(t)})});function isVisible(e){if(!(e instanceof Element))return!1;const n=getComputedStyle(e);if(n.display==="none")return!1;if(n.visibility!=="visible")return!1;if(n.opacity<.1)return!1;if(e.offsetWidth+e.offsetHeight+e.getBoundingClientRect().height+e.getBoundingClientRect().width===0)return!1;const t={x:e.getBoundingClientRect().left+e.offsetWidth/2,y:e.getBoundingClientRect().top+e.offsetHeight/2};if(t.x<0)return!1;if(t.x>(document.documentElement.clientWidth||window.innerWidth))return!1;if(t.y<0)return!1;if(t.y>(document.documentElement.clientHeight||window.innerHeight))return!1;let s=document.elementFromPoint(t.x,t.y);do if(s===e)return!0;while(s=s.parentNode)return!1}function clearActiveStatesInTableOfContents(){document.querySelectorAll("nav li").forEach(e=>{e.classList.remove("active")})}function getDepth(e){for(var t=0;e!==null&&e.tagName.toLowerCase()!=="ul";)t++,e=e.parentElement;return t}function navItems(){var e=document.querySelectorAll("nav nav li a");return Array.from(e).filter(e=>e.href!=null&&e.hash.startsWith("#"))}function lasItemInNavBarVisible(){var e=navItems().slice(-1)[0];return isVisible(e)}document.addEventListener("DOMContentLoaded",function(){if(!enableTruncate)return;var e=navItems();console.log(e),lasItemInNavBarVisible()||(filterDepth=!0,e.forEach(function(e){var t=getDepth(e.parentElement);t>MAX_DEPTH&&e.parentElement.classList.add("depth-nested")}))})</script></body></html>