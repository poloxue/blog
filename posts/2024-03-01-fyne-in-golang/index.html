<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>一个 Go 实现的跨平台 GUI 框架 Fyne - POLOXUE's BLOG</title><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="一个 Go 实现的跨平台 GUI 框架 Fyne"><meta itemprop=description content="Go 一直以来都没有一个标准 GUI 库，Go 官方也没有提供。在 Go 实现的几个 GUI 库中，Fyne 算是最出色的，它有着简洁的API、支持跨平台能力，且高度可扩展。这也就是说，Fyne 是用来开发 App。"><meta itemprop=datePublished content="2024-03-07T08:00:00+08:00"><meta itemprop=dateModified content="2024-03-07T08:00:00+08:00"><meta itemprop=wordCount content="818"><meta itemprop=keywords content><meta property="og:title" content="一个 Go 实现的跨平台 GUI 框架 Fyne"><meta property="og:description" content="Go 一直以来都没有一个标准 GUI 库，Go 官方也没有提供。在 Go 实现的几个 GUI 库中，Fyne 算是最出色的，它有着简洁的API、支持跨平台能力，且高度可扩展。这也就是说，Fyne 是用来开发 App。"><meta property="og:type" content="article"><meta property="og:url" content="https://www.poloxue.com/posts/2024-03-01-fyne-in-golang/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-07T08:00:00+08:00"><meta property="article:modified_time" content="2024-03-07T08:00:00+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="一个 Go 实现的跨平台 GUI 框架 Fyne"><meta name=twitter:description content="Go 一直以来都没有一个标准 GUI 库，Go 官方也没有提供。在 Go 实现的几个 GUI 库中，Fyne 算是最出色的，它有着简洁的API、支持跨平台能力，且高度可扩展。这也就是说，Fyne 是用来开发 App。"><script data-goatcounter=https://poloxue.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/main.css><link rel=stylesheet type=text/css media=screen href=https://www.poloxue.com/css/extra.css><link id=dark-scheme rel=stylesheet type=text/css href=https://www.poloxue.com/css/dark.css><script src=https://www.poloxue.com/js/feather.min.js></script>
<script src=https://www.poloxue.com/js/main.js></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script>
<script>MathJax={tex:{displayMath:[["[","]"],["$$","$$"]],inlineMath:[["(",")"],["$","$"]]}}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7019080091542951" crossorigin=anonymous></script></head><body><div class="container-wide wrapper"><div class=header><div class=avatar><a href=https://www.poloxue.com/><img src=/avatar.png alt="POLOXUE's BLOG"></a></div><h1 class=site-title><a href=https://www.poloxue.com/>POLOXUE's BLOG</a></h1><div class=site-description><nav class="nav social"><ul class=flat><li><a href=https://github.com/poloxue/ title=Github><i data-feather=github></i></a></li><li><a href=/posts/index.xml title=RSS><i data-feather=rss></i></a></li><li><a href=/ title=Wechat><i data-feather=message-circle></i></a></li><span class=scheme-toggle><a href=# id=scheme-toggle></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>文章列表</a></li><li><a href=/tags>分类标签</a></li><li><a href=https://crypto.poloxue.com/>每日币圈</a></li><li><a href=/about/about>关于我</a></li></ul></nav></div><div class=article-nav id=article-nav-id><div class=post><div class=post-header><div class=meta><div class=date><span class=day>07</span>
<span class=rest>Mar 2024</span></div></div><div class=matter><h1 class=title>一个 Go 实现的跨平台 GUI 框架 Fyne</h1></div></div><aside class="show-on-mobile toc" id=static-toc><header><h3>Contents</h3></header><nav id=TableOfContents><ol><li><a href=#安装-fyne>安装 fyne</a></li><li><a href=#创建第一个应用>创建第一个应用</a></li><li><a href=#布局和控件>布局和控件</a><ol><li><a href=#布局管理>布局管理</a></li><li><a href=#更多控件>更多控件</a></li></ol></li><li><a href=#fyne-中的自定义>Fyne 中的自定义</a><ol><li><a href=#自定义控件>自定义控件</a></li><li><a href=#其他自定义>其他自定义</a></li></ol></li><li><a href=#数据绑定>数据绑定</a></li><li><a href=#结语>结语</a></li></ol></nav></aside><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2024-03/2024-03-01-fyne-in-golang-01.png alt></p><p>今天，推荐一个 Go 实现的 GUI 库 - fyne。</p><p>Go 官方也没有提供标准的 GUI 框架，在 Go 实现的几个 GUI 库中，Fyne 算是最出色的，它有着简洁的API、支持跨平台能力，且高度可扩展。这也就是说，Fyne 是可以开发 App。</p><p>本文将尝试介绍下 Fyne，希望对大家快速上手这个 GUI 框架有所帮助。我最近产生了不少想法，其中有些是对 GUI 有要求的，就想着折腾用 Go 实现，而不是用那些已经很流行和成熟的 GUI 框架。</p><p>在写这篇文章时，顺手搞了下它的中文版文档，文档查看 <a href=https://www.poloxue.com/gofyne>www.poloxue.com/gofyne</a>，希望能帮助那些想继续深入这个框架的朋友。</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2024-03/2024-03-01-fyne-in-golang-15.png alt></p><h2 id=安装-fyne>安装 fyne</h2><p>开始前，确保已成功安装 Go，如果是 MacOS X 系统，要确认安装了 xcode。</p><p>如下使用 <code>go get</code> 命令安装 Fyne。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ mkdir hellofyne
</span></span><span style=display:flex><span>$ cd helloyfyne
</span></span><span style=display:flex><span>$ go mod init hellofyne
</span></span><span style=display:flex><span>$ go get fyne.io/fyne/v2@latest
</span></span><span style=display:flex><span>$ go install fyne.io/fyne/v2/cmd/fyne@latest
</span></span></code></pre></td></tr></table></div></div><p>如果想立刻查看 fyne 提供的演示案例，通过命令检查：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ go run fyne.io/fyne/v2/cmd/fyne_demo@latest
</span></span></code></pre></td></tr></table></div></div><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2024-03/2024-03-01-fyne-in-golang-04-v1.png alt></p><p>看起来，这里面的案例还是不够丰富的。</p><p>安装工作到此就完成了。Fyne 对不同系统有不同依赖，如果安装过程中遇到问题，细节可查看官方提供的<a href=https://www.poloxue.com/gofyne/docs/01-started/01-index/>安装文档</a>。</p><h2 id=创建第一个应用>创建第一个应用</h2><p>由于 Go 简洁的语法和 fyne 的设计，使用 fyne 创建一个 GUI 应用异常简单。</p><p>以下是一个创建基础窗口的例子：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;fyne.io/fyne/v2/app&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;fyne.io/fyne/v2/container&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;fyne.io/fyne/v2/widget&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>a</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>New</span>()
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>w</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>NewWindow</span>(<span style=color:#e6db74>&#34;Hello Fyne&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>SetContent</span>(<span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewLabel</span>(<span style=color:#e6db74>&#34;Welcome to Fyne!&#34;</span>))
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>ShowAndRun</span>()
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>这段代码创建了一个包含标签的窗口。</p><p>通过 <code>app.New()</code> 初始化一个 Fyne 应用实例。然后，创建一个标题为 &ldquo;Hello Fyne&rdquo; 的窗口，并设置内容为包含 &ldquo;Welcome to Fyne!&rdquo; 文本标签。最后，通过<code>w.ShowAndRun()</code>显示窗口并启动应用的事件循环。</p><p>fyne 中窗口的默认大小是其包含的内容决定，也可预置大小。</p><p>如在创建窗口后，提供 <code>Resize</code> 重新调整大小。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Resize</span>(<span style=color:#a6e22e>fyne</span>.<span style=color:#a6e22e>NewSize</span>(<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>))
</span></span></code></pre></td></tr></table></div></div><p>还有，一个 app 下可以有多个窗口的，示例代码：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>btn</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewButton</span>(<span style=color:#e6db74>&#34;Create a widnow&#34;</span>, <span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>w2</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>NewWindow</span>(<span style=color:#e6db74>&#34;Window 02&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>w2</span>.<span style=color:#a6e22e>Resize</span>(<span style=color:#a6e22e>fyne</span>.<span style=color:#a6e22e>NewSize</span>(<span style=color:#ae81ff>200</span>, <span style=color:#ae81ff>200</span>))
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>w2</span>.<span style=color:#a6e22e>Show</span>()
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>SetContent</span>(<span style=color:#a6e22e>btn</span>)
</span></span></code></pre></td></tr></table></div></div><p>我们创建一个按钮，它的点击事件是创建一个新的窗口并显示。</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2024-03/2024-03-01-fyne-in-golang-08.gif alt></p><h2 id=布局和控件>布局和控件</h2><p>布局和控件是 GUI 应用程序设计中必不可少的两类组件。Fyne 提供了多种布局管理器和标准的 UI 控件，支持创建更复杂的界面。</p><h3 id=布局管理>布局管理</h3><p>Fyne 中的布局的实现位于 <code>container</code> 包中。它提供了多种不同布局方式安排窗口中的元素。最基本的布局方式有 <code>HBox</code> 水平布局和 <code>VBox</code> 垂直布局。</p><p>通过 <code>HBox</code> 创建水平布局的代码如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>SetContent</span>(<span style=color:#a6e22e>container</span>.<span style=color:#a6e22e>NewHBox</span>(<span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewButton</span>(<span style=color:#e6db74>&#34;Left&#34;</span>, <span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;Left button clicked&#34;</span>)
</span></span><span style=display:flex><span>}), <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewButton</span>(<span style=color:#e6db74>&#34;Right&#34;</span>, <span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;Right button clicked&#34;</span>)
</span></span><span style=display:flex><span>})))
</span></span></code></pre></td></tr></table></div></div><p>显示效果：</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2024-03/2024-03-01-fyne-in-golang-09.png alt></p><p>通过 <code>VBox</code> 创建垂直布局的例子。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>SetContent</span>(<span style=color:#a6e22e>container</span>.<span style=color:#a6e22e>NewVBox</span>(<span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewButton</span>(<span style=color:#e6db74>&#34;Top&#34;</span>, <span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;Top button clicked&#34;</span>)
</span></span><span style=display:flex><span>}), <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewButton</span>(<span style=color:#e6db74>&#34;Bottom&#34;</span>, <span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;Bottom button clicked&#34;</span>)
</span></span><span style=display:flex><span>})))
</span></span></code></pre></td></tr></table></div></div><p>显示效果：</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2024-03/2024-03-01-fyne-in-golang-10.png alt></p><p>Fyne 除了基础的水平（<code>HBoxLayout</code>）和垂直（<code>VBoxLayout</code>）布局，还提供了<code>GridLayout</code>、<code>FormLayout</code> 甚至是混合布局 C<code>ombinedLayout</code> 等高级布局方式。</p><p>如 <code>GridLayout</code>可以将元素均匀地分布在网格中，而<code>FormLayout</code>适用于创建表单，自动排列标签和字段。这些灵活的布局选项支持创建更复杂和功能丰富的GUI界面。</p><p>官方文档中的布局列表查看：<a href=https://www.poloxue.com/gofyne>Layout List</a>。</p><h3 id=更多控件>更多控件</h3><p>前面的演示案例中，用到了两个控件：Label 和 Button，Fyne 还支持其他多种控件，它们都为于 <code>widget</code> 包中。</p><p>我尝试在一份代码中展示出来，如下是常见控件一览：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// 标签 Label
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>label</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewLabel</span>(<span style=color:#e6db74>&#34;Label&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>// 按钮 Button
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>button</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewButton</span>(<span style=color:#e6db74>&#34;Button&#34;</span>, <span style=color:#66d9ef>func</span>() {})
</span></span><span style=display:flex><span><span style=color:#75715e>// 输入框 Entry
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>entry</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewEntry</span>()
</span></span><span style=display:flex><span><span style=color:#a6e22e>entry</span>.<span style=color:#a6e22e>SetPlaceHolder</span>(<span style=color:#e6db74>&#34;Entry&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>// 复选框 Check
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>check</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewCheck</span>(<span style=color:#e6db74>&#34;Check&#34;</span>, <span style=color:#66d9ef>func</span>(<span style=color:#66d9ef>bool</span>) {})
</span></span><span style=display:flex><span><span style=color:#75715e>// 单选框 Check
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>radio</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewRadioGroup</span>([]<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;Option 1&#34;</span>, <span style=color:#e6db74>&#34;Option 2&#34;</span>}, <span style=color:#66d9ef>func</span>(<span style=color:#66d9ef>string</span>) {})
</span></span><span style=display:flex><span><span style=color:#75715e>// 选择框
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>selectEntry</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewSelectEntry</span>([]<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;Option A&#34;</span>, <span style=color:#e6db74>&#34;Option B&#34;</span>}
</span></span><span style=display:flex><span><span style=color:#75715e>// 进度条
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>progressBar</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewProgressBar</span>()
</span></span><span style=display:flex><span><span style=color:#75715e>// 滑块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>slider</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewSlider</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>// 组合框
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>combo</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewSelect</span>([]<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;Option A&#34;</span>, <span style=color:#e6db74>&#34;Option B&#34;</span>, <span style=color:#e6db74>&#34;Option C&#34;</span>}, <span style=color:#66d9ef>func</span>(<span style=color:#66d9ef>string</span>) {})
</span></span><span style=display:flex><span><span style=color:#75715e>// 表单项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>formItem</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewFormItem</span>(<span style=color:#e6db74>&#34;FormItem&#34;</span>, <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewEntry</span>())
</span></span><span style=display:flex><span><span style=color:#a6e22e>form</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewForm</span>(<span style=color:#a6e22e>formItem</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>// 手风琴
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>accordion</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewAccordion</span>(<span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewAccordionItem</span>(<span style=color:#e6db74>&#34;Accordion&#34;</span>, <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewLabel</span>(<span style=color:#e6db74>&#34;Content&#34;</span>)))
</span></span><span style=display:flex><span><span style=color:#75715e>// Tab 选择
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>tabs</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>container</span>.<span style=color:#a6e22e>NewAppTabs</span>(
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>container</span>.<span style=color:#a6e22e>NewTabItem</span>(<span style=color:#e6db74>&#34;Tab 1&#34;</span>, <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewLabel</span>(<span style=color:#e6db74>&#34;Content 1&#34;</span>)),
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>container</span>.<span style=color:#a6e22e>NewTabItem</span>(<span style=color:#e6db74>&#34;Tab 2&#34;</span>, <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewLabel</span>(<span style=color:#e6db74>&#34;Content 2&#34;</span>)),
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 弹出对话框示例按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>dialogButton</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewButton</span>(<span style=color:#e6db74>&#34;Show Dialog&#34;</span>, <span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>dialog</span>.<span style=color:#a6e22e>ShowInformation</span>(<span style=color:#e6db74>&#34;Dialog&#34;</span>, <span style=color:#e6db74>&#34;Dialog Content&#34;</span>, <span style=color:#a6e22e>w</span>)
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 滚动布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>content</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>container</span>.<span style=color:#a6e22e>NewVScroll</span>(<span style=color:#a6e22e>container</span>.<span style=color:#a6e22e>NewVBox</span>(
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>label</span>, <span style=color:#a6e22e>button</span>, <span style=color:#a6e22e>entry</span>, <span style=color:#a6e22e>check</span>, <span style=color:#a6e22e>radio</span>, <span style=color:#a6e22e>selectEntry</span>, <span style=color:#a6e22e>progressBar</span>, <span style=color:#a6e22e>slider</span>,
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>combo</span>, <span style=color:#a6e22e>form</span>, <span style=color:#a6e22e>accordion</span>, <span style=color:#a6e22e>tabs</span>, <span style=color:#a6e22e>dialogButton</span>,
</span></span><span style=display:flex><span>))
</span></span><span style=display:flex><span><span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>SetContent</span>(<span style=color:#a6e22e>content</span>)
</span></span></code></pre></td></tr></table></div></div><p>演示效果：</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2024-03/2024-03-01-fyne-in-golang-12.gif alt></p><h2 id=fyne-中的自定义>Fyne 中的自定义</h2><p>如果在实际项目中使用 Fyne，基本上是要使用 Fyne 的自定义能力。Fyne 提供了自定义控件、布局和主题等。</p><h3 id=自定义控件>自定义控件</h3><p>fyne 是支持实现自定义控件的，这涉及定义控件的绘制方法和布局逻辑。我们主要是实现两个接口：<code>fyne.Widget</code> 和 <code>fyne.WidgetRenderer</code>。</p><p><code>fyne.Widget</code> 的定义如下所示：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Widget</span> <span style=color:#66d9ef>interface</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>CanvasObject</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>CreateRenderer</span>() <span style=color:#a6e22e>WidgetRenderer</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p><code>CreateRenderer</code> 方法返回的就是 <code>WiddgetRenderer</code>，用于定义控件渲染和布局的逻辑。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>WidgetRenderer</span> <span style=color:#66d9ef>interface</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Destroy</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Layout</span>(<span style=color:#a6e22e>Size</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>MinSize</span>() <span style=color:#a6e22e>Size</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Objects</span>() []<span style=color:#a6e22e>CanvasObject</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Refresh</span>()
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>这样拆分的目标是为将了控件的逻辑和 UI 绘制分离开来，在 <code>Widget</code> 中专注于逻辑，而 <code>WidgetRenderer</code> 中专注于渲染布局。</p><p>假设实现一个类似 Label 的控件，类型定义：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>CustomLabel</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>BaseWidget</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Text</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>它继承了 <code>wiget.BaseWidget</code> 基本控件实现，<code>Text</code> 就是要 <code>Label</code> 显示的文本。还要给给 <code>CustomLabel</code> 实现 <code>CreateRenderer</code> 方法。</p><p>定义 <code>CustomLabel</code> 创建函数：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>NewCustomLabel</span>(<span style=color:#a6e22e>text</span> <span style=color:#66d9ef>string</span>) <span style=color:#f92672>*</span><span style=color:#a6e22e>CustomLabel</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>label</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>CustomLabel</span>{<span style=color:#a6e22e>Text</span>: <span style=color:#a6e22e>text</span>}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>label</span>.<span style=color:#a6e22e>ExtendBaseWidget</span>(<span style=color:#a6e22e>label</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>label</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p><code>customWidgetRenderer</code> 类型定义如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>customWidgetRenderer</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>text</span>  <span style=color:#f92672>*</span><span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>Text</span> <span style=color:#75715e>// 使用canvas.Text来绘制文本
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>label</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>CustomLabel</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>实现 <code>CustomLabel</code> 的 <code>CreateRenderer</code> 方法。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>label</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>CustomLabel</span>) <span style=color:#a6e22e>CreateRenderer</span>() <span style=color:#a6e22e>fyne</span>.<span style=color:#a6e22e>WidgetRenderer</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>text</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>canvas</span>.<span style=color:#a6e22e>NewText</span>(<span style=color:#a6e22e>label</span>.<span style=color:#a6e22e>Text</span>, <span style=color:#a6e22e>theme</span>.<span style=color:#a6e22e>ForegroundColor</span>())
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>text</span>.<span style=color:#a6e22e>Alignment</span> = <span style=color:#a6e22e>fyne</span>.<span style=color:#a6e22e>TextAlignCenter</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>customLabelRenderer</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>text</span>:  <span style=color:#a6e22e>text</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>label</span>: <span style=color:#a6e22e>label</span>,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>构建 <code>Renderer</code> 变量，使用 <code>canvas</code> 创建 <code>Text</code> 文本框，为适配主题使用主题配置前景色。还有，设置文本居中显示。</p><p>而 <code>customLabelRenderer</code> 要实现 <code>WidgetRender</code> 接口定义的所有方法。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>customLabelRenderer</span>) <span style=color:#a6e22e>MinSize</span>() <span style=color:#a6e22e>fyne</span>.<span style=color:#a6e22e>Size</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>text</span>.<span style=color:#a6e22e>MinSize</span>()
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>customLabelRenderer</span>) <span style=color:#a6e22e>Layout</span>(<span style=color:#a6e22e>size</span> <span style=color:#a6e22e>fyne</span>.<span style=color:#a6e22e>Size</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>text</span>.<span style=color:#a6e22e>Resize</span>(<span style=color:#a6e22e>size</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>customLabelRenderer</span>) <span style=color:#a6e22e>Refresh</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>text</span>.<span style=color:#a6e22e>Text</span> = <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>label</span>.<span style=color:#a6e22e>Text</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>text</span>.<span style=color:#a6e22e>Color</span> = <span style=color:#a6e22e>theme</span>.<span style=color:#a6e22e>ForegroundColor</span>() <span style=color:#75715e>// 确保文本颜色更新
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>text</span>.<span style=color:#a6e22e>Refresh</span>()
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>customLabelRenderer</span>) <span style=color:#a6e22e>BackgroundColor</span>() <span style=color:#a6e22e>color</span>.<span style=color:#a6e22e>Color</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>theme</span>.<span style=color:#a6e22e>BackgroundColor</span>()
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>customLabelRenderer</span>) <span style=color:#a6e22e>Objects</span>() []<span style=color:#a6e22e>fyne</span>.<span style=color:#a6e22e>CanvasObject</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> []<span style=color:#a6e22e>fyne</span>.<span style=color:#a6e22e>CanvasObject</span>{<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>text</span>}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>customLabelRenderer</span>) <span style=color:#a6e22e>Destroy</span>() {}
</span></span></code></pre></td></tr></table></div></div><p>在 main 函数中，尝试使用这个控件。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>a</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>New</span>()
</span></span><span style=display:flex><span><span style=color:#a6e22e>w</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>NewWindow</span>(<span style=color:#e6db74>&#34;Custom Label&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>SetContent</span>(<span style=color:#a6e22e>NewCustomLabel</span>(<span style=color:#e6db74>&#34;Hello&#34;</span>))
</span></span><span style=display:flex><span><span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>ShowAndRun</span>()
</span></span></code></pre></td></tr></table></div></div><p>显示的效果和 Label 控件是类似的。</p><h3 id=其他自定义>其他自定义</h3><p>其他自定义能力，如 Layout、Theme，我就不展开介绍。如果有机会，写点实际应用案例。如果基于案例介绍，会更有体悟吧。</p><p>还有，Fyne 的官方文档写的挺易读的，可直接看它的文档。</p><h2 id=数据绑定>数据绑定</h2><p>Fyne 从 v2.0.0 开始支持数据绑定。它让控件和与数据实时连接，数据更改会自动反映在UI上，反之亦然。</p><p>控件为了支持数据绑定能力，一般会提供如 <code>NewXXXWithData</code> 的接口。直接通过场景说明，场景：编辑输入框的内容，可直接实现到 Label 上。</p><p>核心代码如下所示：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// 创建一个字符串绑定
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>textBind</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>binding</span>.<span style=color:#a6e22e>NewString</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 创建一个 Entry，将其内容绑定到 textBind
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>entry</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewEntryWithData</span>(<span style=color:#a6e22e>textBind</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 创建一个 Label，也将其内容绑定到同一个 textBind
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>label</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>widget</span>.<span style=color:#a6e22e>NewLabelWithData</span>(<span style=color:#a6e22e>textBind</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 使用容器放置 Entry 和 Label，以便它们都显示在窗口中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>content</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>container</span>.<span style=color:#a6e22e>NewVBox</span>(<span style=color:#a6e22e>entry</span>, <span style=color:#a6e22e>label</span>)
</span></span></code></pre></td></tr></table></div></div><p>显示效果，如下所示：</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2024-03/2024-03-01-fyne-in-golang-13.gif alt></p><p>尝试让前面自定义的 <code>CustomLabel</code> 支持数据绑定能力。只要创建一个 <code>NewCustomLabelWithData</code> 构造函数。</p><p>如下所示：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>NewCustomLabelWithData</span>(<span style=color:#a6e22e>data</span> <span style=color:#a6e22e>binding</span>.<span style=color:#a6e22e>String</span>) <span style=color:#f92672>*</span><span style=color:#a6e22e>CustomLabel</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>label</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>CustomLabel</span>{}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>label</span>.<span style=color:#a6e22e>ExtendBaseWidget</span>(<span style=color:#a6e22e>label</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>AddListener</span>(<span style=color:#a6e22e>binding</span>.<span style=color:#a6e22e>NewDataListener</span>(<span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>text</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>Get</span>()
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>label</span>.<span style=color:#a6e22e>Text</span> = <span style=color:#a6e22e>text</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>label</span>.<span style=color:#a6e22e>Refresh</span>()
</span></span><span style=display:flex><span>	}))
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>label</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>通过 <code>data</code> 监听数据变化后，立刻刷新组件。</p><p><img src=https://cdn.jsdelivr.net/gh/poloxue/images@2024-03/2024-03-01-fyne-in-golang-14.gif alt></p><p>如上所示，我们这个自定义 Label 中的文本是居中显示的。</p><p>数据绑定的核心是监听器模式（Observer pattern）。每个绑定对象内部维护了一个监听器列表，当数据变化时，这些监听器会被通知更新。</p><p>在 Fyne 中，通过 <code>data.AddListner()</code> 将 UI 组件与数据绑定对象绑定时，实际上是在数据对象上注册了一个监听器，这个监听器会在数据变化时更新 UI 组件的状态。</p><h2 id=结语>结语</h2><p>Fyne 是简单、强大和跨平台的 GUI 工具，使得用 GO 开发现代 GUI 应用多了一个优秀选择。随着对 Fyne 的深入，它能够更加灵活地构建出符合需求的应用。</p><p>我喜欢用 Go 的原因，很重要的原因就是它的简洁性，很容易看到本质的东西，但又无需理解太复杂的编程概念。</p><div>本文来源于 <a href=https://www.poloxue.com>POLOXUE's BLOG</a>，地址： <a href=https://www.poloxue.com/posts/2024-03-01-fyne-in-golang/>一个 Go 实现的跨平台 GUI 框架 Fyne</a></div></div><nav class="hide-on-mobile section-nav"><nav id=TableOfContents><ol><li><a href=#安装-fyne>安装 fyne</a></li><li><a href=#创建第一个应用>创建第一个应用</a></li><li><a href=#布局和控件>布局和控件</a><ol><li><a href=#布局管理>布局管理</a></li><li><a href=#更多控件>更多控件</a></li></ol></li><li><a href=#fyne-中的自定义>Fyne 中的自定义</a><ol><li><a href=#自定义控件>自定义控件</a></li><li><a href=#其他自定义>其他自定义</a></li></ol></li><li><a href=#数据绑定>数据绑定</a></li><li><a href=#结语>结语</a></li></ol></nav></nav></div><div class=post><hr class=footer-separator><div class=tags></div><div class=back><a href=https://www.poloxue.com/><span aria-hidden=true>← Back</span></a></div><div class=back></div></div><div class=post><img style=width:85% src=https://cdn.jsdelivr.net/gh/poloxue/images@main/wechat.png><div class=utterances></div><script src=https://utteranc.es/client.js repo=poloxue/blog issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div><div class="footer wrapper"><nav class=nav><div>2024 Polo Xue All rights reserved</div></nav></div><script>feather.replace()</script><script>var enableTruncate=!0,filterDepth=!1;const MAX_DEPTH=9;window.addEventListener("DOMContentLoaded",()=>{const e=new IntersectionObserver(e=>{e.reverse().forEach(e=>{const n=e.target.getAttribute("id");if(e.intersectionRatio>0){var t=document.querySelectorAll(`nav li a[href="#${n}"]`);t!=null&&t.forEach(e=>{if(e!=null){var t=getDepth(e.parentElement);filterDepth&&t<=MAX_DEPTH&&(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))}else filterDepth||(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))})}})});document.querySelectorAll("h1[id],h2[id],h3[id],h4[id]").forEach(t=>{e.observe(t)})});function isVisible(e){if(!(e instanceof Element))return!1;const n=getComputedStyle(e);if(n.display==="none")return!1;if(n.visibility!=="visible")return!1;if(n.opacity<.1)return!1;if(e.offsetWidth+e.offsetHeight+e.getBoundingClientRect().height+e.getBoundingClientRect().width===0)return!1;const t={x:e.getBoundingClientRect().left+e.offsetWidth/2,y:e.getBoundingClientRect().top+e.offsetHeight/2};if(t.x<0)return!1;if(t.x>(document.documentElement.clientWidth||window.innerWidth))return!1;if(t.y<0)return!1;if(t.y>(document.documentElement.clientHeight||window.innerHeight))return!1;let s=document.elementFromPoint(t.x,t.y);do if(s===e)return!0;while(s=s.parentNode)return!1}function clearActiveStatesInTableOfContents(){document.querySelectorAll("nav li").forEach(e=>{e.classList.remove("active")})}function getDepth(e){for(var t=0;e!==null&&e.tagName.toLowerCase()!=="ul";)t++,e=e.parentElement;return t}function navItems(){var e=document.querySelectorAll("nav nav li a");return Array.from(e).filter(e=>e.href!=null&&e.hash.startsWith("#"))}function lasItemInNavBarVisible(){var e=navItems().slice(-1)[0];return isVisible(e)}document.addEventListener("DOMContentLoaded",function(){if(!enableTruncate)return;var e=navItems();console.log(e),lasItemInNavBarVisible()||(filterDepth=!0,e.forEach(function(e){var t=getDepth(e.parentElement);t>MAX_DEPTH&&e.parentElement.classList.add("depth-nested")}))})</script></body></html>